(()=>{"use strict";var e,t,i,s,n,a,o,r,h,l,c,d,u;!function(e){e.KEYBOARD="keyboard",e.MOUSE="mouse",e.TOUCH="touch"}(e||(e={})),function(e){e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"}(t||(t={})),function(e){e.BEGAN="began",e.MOVED="moved",e.STATIONARY="stationary",e.ENDED="ended",e.CANCELED="canceled"}(i||(i={})),function(e){e.BOX="box",e.CIRCLE="circle",e.POLYGON="polygon"}(s||(s={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.PLAYER=1]="PLAYER",e[e.ENEMY=2]="ENEMY",e[e.PROJECTILE=3]="PROJECTILE",e[e.ENVIRONMENT=4]="ENVIRONMENT",e[e.TRIGGER=5]="TRIGGER",e[e.UI=6]="UI",e[e.GROUND=7]="GROUND",e[e.ALL=8]="ALL"}(n||(n={})),function(e){e.IMAGE="image",e.AUDIO="audio",e.TEXT="text",e.JSON="json",e.FONT="font"}(a||(a={})),function(e){e.NOT_LOADED="not_loaded",e.LOADING="loading",e.LOADED="loaded",e.ERROR="error"}(o||(o={})),function(e){e.NOT_LOADED="not_loaded",e.LOADING="loading",e.LOADED="loaded",e.UNLOADING="unloading"}(r||(r={})),function(e){e.PLAYING="playing",e.PAUSED="paused",e.GAMEOVER="game_over",e.RESTART="restart"}(h||(h={})),function(e){e.ORTHOGRAPHIC="orthographic",e.PERSPECTIVE="perspective"}(l||(l={})),function(e){e.CAPTURE="capture",e.TARGET="target",e.BUBBLE="bubble"}(c||(c={})),function(e){e.TOP_LEFT="top_left",e.TOP_CENTER="top_center",e.TOP_RIGHT="top_right",e.MIDDLE_LEFT="middle_left",e.MIDDLE_CENTER="middle_center",e.MIDDLE_RIGHT="middle_right",e.BOTTOM_LEFT="bottom_left",e.BOTTOM_CENTER="bottom_center",e.BOTTOM_RIGHT="bottom_right"}(d||(d={})),function(e){e.NORMAL="normal",e.HOVERED="hovered",e.PRESSED="pressed",e.DISABLED="disabled"}(u||(u={}));const g="trigger_enter",m="collision_enter",p="collision_exit";var E,y;!function(e){e.FADE_IN="fade_in",e.FADE_OUT="fade_out",e.SLIDE_IN_FROM_TOP="slide_in_from_top",e.SLIDE_IN_FROM_BOTTOM="slide_in_from_bottom",e.SLIDE_IN_FROM_LEFT="slide_in_from_left",e.SLIDE_IN_FROM_RIGHT="slide_in_from_right",e.SCALE_IN="scale_in",e.SCALE_OUT="scale_out",e.BOUNCE="bounce",e.PULSE="pulse",e.SHAKE="shake",e.FadeIn="FadeIn"}(E||(E={})),function(e){e.EXPLOSION="explosion",e.STARS="stars",e.SPARKLES="sparkles",e.SMOKE="smoke",e.FIRE="fire",e.CONFETTI="confetti",e.HEARTS="hearts",e.SNOW="snow"}(y||(y={}));class f{static get deltaTime(){return this._deltaTime*this._timeScale}static get unscaledDeltaTime(){return this._unscaledDeltaTime}static get totalTime(){return this._totalTime}static get timeScale(){return this._timeScale}static set timeScale(e){this._timeScale=Math.max(0,e)}static get frameCount(){return this._frameCount}static get fps(){return this._fps}static update(e){this._unscaledDeltaTime=e,this._deltaTime=e,this._totalTime+=e,this._frameCount++,this._fpsFrameCount++;const t=this._totalTime;t-this._lastFpsUpdate>=1e3&&(this._fps=Math.round(1e3*this._fpsFrameCount/(t-this._lastFpsUpdate)),this._fpsFrameCount=0,this._lastFpsUpdate=t)}static reset(){this._deltaTime=0,this._unscaledDeltaTime=0,this._totalTime=0,this._frameCount=0,this._fps=0,this._lastFpsUpdate=0,this._fpsFrameCount=0}}f._deltaTime=0,f._unscaledDeltaTime=0,f._totalTime=0,f._timeScale=1,f._frameCount=0,f._fps=0,f._lastFpsUpdate=0,f._fpsFrameCount=0;class A{constructor(e,t={}){this.defaultPrevented=!1,this._propagationStopped=!1,this.type=e,this.bubbles=t.bubbles||!1,this.cancelable=t.cancelable||!1,this.data=t.data,this.timeStamp=f.totalTime,this.phase=c.TARGET}preventDefault(){this.cancelable&&(this.defaultPrevented=!0)}stopPropagation(){this._propagationStopped=!0}stopImmediatePropagation(){this._propagationStopped=!0}get propagationStopped(){return this._propagationStopped}}class S{constructor(){this.events=new Map}addEventListener(e,t,i={}){this.events.has(e)||this.events.set(e,[]);const s=this.events.get(e);s.push({listener:t,options:i}),s.sort((e,t)=>(t.options.priority||0)-(e.options.priority||0))}removeEventListener(e,t){const i=this.events.get(e);if(i){const e=i.findIndex(e=>e.listener===t);-1!==e&&i.splice(e,1)}}dispatchEvent(e,t){const i="string"==typeof e?new A(e,{data:t}):e;i.target||(i.target=this),i.currentTarget=this;const s=this.events.get(i.type);if(s)for(const{listener:e,options:t}of s)try{e.call(this,i),t.once&&this.removeEventListener(i.type,e)}catch(e){console.error("Error in event listener:",e)}return!i.defaultPrevented}removeAllEventListeners(e){e?this.events.delete(e):this.events.clear()}}var b=function(e,t,i,s){return new(i||(i=Promise))(function(n,a){function o(e){try{h(s.next(e))}catch(e){a(e)}}function r(e){try{h(s.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,r)}h((s=s.apply(e,t||[])).next())})};class T extends S{constructor(){super(),this.audioContext=null,this.masterGainNode=null,this.clips=new Map,this.activeSources=new Set,this.bgmSource=null,this.bgmName=null,this.masterVolume=1,this.enabled=!0,this.initializeAudioContext()}initializeAudioContext(){var e;try{const t=null!==(e=window.AudioContext)&&void 0!==e?e:window.webkitAudioContext;if(!t)throw new Error("Web Audio API not supported");this.audioContext=new t,this.masterGainNode=this.audioContext.createGain(),this.masterGainNode.connect(this.audioContext.destination),document.addEventListener("click",this.resumeAudioContext.bind(this),{once:!0}),document.addEventListener("keydown",this.resumeAudioContext.bind(this),{once:!0})}catch(e){console.warn("Web Audio API not supported:",e)}}resumeAudioContext(){return b(this,void 0,void 0,function*(){if(this.audioContext&&"suspended"===this.audioContext.state)try{yield this.audioContext.resume()}catch(e){console.error("Failed to resume audio context:",e)}})}playBackgroundMusic(e,t={}){var i,s;if(this.bgmName=e,this.stopBackgroundMusic(),!this.enabled)return;const n=this.clips.get(e);if(n)try{const e=this.audioContext.createBufferSource(),a=this.audioContext.createGain();e.buffer=n.buffer,e.loop=null===(i=t.loop)||void 0===i||i,a.gain.value=(null!==(s=t.volume)&&void 0!==s?s:n.volume)*this.masterVolume,e.connect(a),a.connect(this.masterGainNode);const o={clip:n,source:e,gainNode:a,isPlaying:!0};this.bgmSource=o,e.onended=()=>{this.bgmSource===o&&(this.bgmSource=null)},e.start()}catch(t){console.error(`Failed to play background music: ${e}`,t)}}stopBackgroundMusic(){this.bgmSource&&this.bgmSource.isPlaying&&(this.bgmSource.source.stop(),this.bgmSource.isPlaying=!1,this.bgmSource=null)}loadSound(e,t){return b(this,void 0,void 0,function*(){if(!this.audioContext)throw new Error("Audio context not available");try{const i=yield fetch(t),s=yield i.arrayBuffer(),n=yield this.audioContext.decodeAudioData(s),a={name:e,buffer:n,volume:1,loop:!1};this.clips.set(e,a),this.dispatchEvent("audio_clip_loaded",{clip:a})}catch(t){throw console.error(`Failed to load audio clip: ${e}`,t),t}})}playSound(e,t=!1,i={}){var s,n;if(!this.enabled||!this.audioContext||!this.masterGainNode)return;if(!t&&this.activeSources.size>0)for(const t of this.activeSources)if(t.clip.name===e&&t.isPlaying)return;const a=this.clips.get(e);if(a)try{const e=this.audioContext.createBufferSource(),t=this.audioContext.createGain();e.buffer=a.buffer,e.loop=null!==(s=i.loop)&&void 0!==s?s:a.loop;const o=(null!==(n=i.volume)&&void 0!==n?n:a.volume)*this.masterVolume;t.gain.value=o,e.connect(t),t.connect(this.masterGainNode);const r={clip:a,source:e,gainNode:t,isPlaying:!0};this.activeSources.add(r),e.onended=()=>{this.activeSources.delete(r)},e.start()}catch(t){console.error(`Failed to play sound: ${e}`,t)}else console.warn(`Audio clip not found: ${e}`)}stopSound(e){this.activeSources.forEach(t=>{t.clip.name===e&&t.isPlaying&&(t.source.stop(),t.isPlaying=!1)})}stopAllSounds(){this.activeSources.forEach(e=>{e.isPlaying&&(e.source.stop(),e.isPlaying=!1)}),this.activeSources.clear()}setMasterVolume(e){this.masterVolume=Math.max(0,Math.min(1,e)),this.masterGainNode&&(this.masterGainNode.gain.value=this.masterVolume)}getMasterVolume(){return this.masterVolume}setEnabled(e){this.enabled=e,e?this.bgmName&&this.playBackgroundMusic(this.bgmName):(this.stopAllSounds(),this.stopBackgroundMusic())}isEnabled(){return this.enabled}}class _{constructor(e=0,t=0){this.x=e,this.y=t}static zero(){return new _(0,0)}static one(){return new _(1,1)}static up(){return new _(0,-1)}static down(){return new _(0,1)}static left(){return new _(-1,0)}static right(){return new _(1,0)}clone(){return new _(this.x,this.y)}set(e,t){return this.x=e,this.y=t,this}add(e){return new _(this.x+e.x,this.y+e.y)}subtract(e){return new _(this.x-e.x,this.y-e.y)}multiply(e){return new _(this.x*e,this.y*e)}divide(e){if(0===e)throw new Error("Division by zero");return new _(this.x/e,this.y/e)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalized(){const e=this.magnitude();return 0===e?_.zero():this.divide(e)}distance(e){return this.subtract(e).magnitude()}dot(e){return this.x*e.x+this.y*e.y}static distance(e,t){return new _(e.x,e.y).distance(t)}static lerp(e,t,i){return i=Math.max(0,Math.min(1,i)),new _(e.x+(t.x-e.x)*i,e.y+(t.y-e.y)*i)}static fromAngle(e,t=1){return new _(Math.cos(e)*t,Math.sin(e)*t)}static isVector2(e){return"object"==typeof e&&null!==e&&"number"==typeof e.x&&"number"==typeof e.y}}class O extends S{constructor(){super(...arguments),this.colliders=new Set,this.collisionMap=new Map}addCollider(e){this.colliders.add(e)}removeCollider(e){this.colliders.delete(e),this.collisionMap.delete(e);for(const t of this.collisionMap.values())t.delete(e)}checkCollisions(){var e,t,i,s;const n=Array.from(this.colliders);if(n.length<2)return;const a=new Map;for(let t=0;t<n.length;t++)for(let i=t+1;i<n.length;i++){const s=n[t],o=n[i];if(s!==o&&(!this.collisionMap.has(s)||!(null===(e=this.collisionMap.get(s))||void 0===e?void 0:e.has(o)))&&s.canCollideWith(o)&&this.checkAABBCollision(s.getBounds(),o.getBounds())){const e=this.createCollisionInfo(s,o);s.onCollision(o,e),o.onCollision(s,e),a.has(s)||a.set(s,new Set),a.has(o)||a.set(o,new Set),a.get(s).add(o),a.get(o).add(s)}}for(const[e,n]of this.collisionMap)for(const o of n)(null===(t=a.get(e))||void 0===t?void 0:t.has(o))||(null===(i=e.onCollisionExit)||void 0===i||i.call(e,o),null===(s=o.onCollisionExit)||void 0===s||s.call(o,e));this.collisionMap=a}checkAABBCollision(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}createCollisionInfo(e,t){const i=e.getBounds(),s=t.getBounds();return{point:new _((i.x+i.width/2+s.x+s.width/2)/2,(i.y+i.height/2+s.y+s.height/2)/2),normal:new _(0,-1),penetration:0,colliderA:e,colliderB:t,relativeVelocity:new _(0,0)}}queryAABB(e){return Array.from(this.colliders).filter(t=>this.checkAABBCollision(e,t.getBounds()))}queryPoint(e){return this.queryAABB({x:e.x,y:e.y,width:1,height:1})}raycast(e,t,i=1/0){let s=null,n=1/0;for(const a of this.colliders){const o=a.getBounds(),r=this.raycastAABB(e,t,o,i);r&&r.distance<n&&(n=r.distance,s={collider:a,point:r.point,normal:r.normal,distance:r.distance,gameObject:a.getGameObject()})}return s}raycastAABB(e,t,i,s){const n=1/t.x,a=1/t.y,o=(i.x-e.x)*n,r=(i.x+i.width-e.x)*n,h=(i.y-e.y)*a,l=(i.y+i.height-e.y)*a,c=Math.max(Math.min(o,r),Math.min(h,l)),d=Math.min(Math.max(o,r),Math.max(h,l));if(d<0||c>d||c>s)return null;const u=c>0?c:d;return{point:new _(e.x+t.x*u,e.y+t.y*u),normal:new _(0,-1),distance:u}}clear(){this.colliders.clear()}getColliderCount(){return this.colliders.size}getActiveCollisionCount(){return 0}}class v extends S{constructor(e){super(),this.keyStates=new Map,this.previousKeyStates=new Map,this.mousePosition=_.zero(),this.mouseDelta=_.zero(),this.mouseButtons=new Map,this.previousMouseButtons=new Map,this.touches=new Map,this.enabled=!0,this.canvas=e,this.setupEventListeners()}setupEventListeners(){document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this)),this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),this.canvas.addEventListener("mouseup",this.onMouseUp.bind(this)),this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this)),this.canvas.addEventListener("contextmenu",e=>e.preventDefault()),this.canvas.addEventListener("touchstart",this.onTouchStart.bind(this)),this.canvas.addEventListener("touchmove",this.onTouchMove.bind(this)),this.canvas.addEventListener("touchend",this.onTouchEnd.bind(this)),this.canvas.addEventListener("touchcancel",this.onTouchCancel.bind(this)),window.addEventListener("blur",()=>{this.clearAllInputs()})}onKeyDown(t){if(!this.enabled)return;t.preventDefault();const i=t.code;this.keyStates.get(i)||this.dispatchEvent("key_down",{inputType:e.KEYBOARD,key:i,isPressed:!0}),this.keyStates.set(i,!0)}onKeyUp(t){if(!this.enabled)return;t.preventDefault();const i=t.code;this.keyStates.set(i,!1),this.dispatchEvent("key_up",{inputType:e.KEYBOARD,key:i,isPressed:!1})}onMouseDown(t){if(!this.enabled)return;t.preventDefault();const i=t.button,s=this.calculateMousePosition(t);this.mouseButtons.set(i,!0),this.dispatchEvent("mouse_down",{inputType:e.MOUSE,button:i,position:s,isPressed:!0})}onMouseUp(t){if(!this.enabled)return;t.preventDefault();const i=t.button,s=this.calculateMousePosition(t);this.mouseButtons.set(i,!1),this.dispatchEvent("mouse_up",{inputType:e.MOUSE,button:i,position:s,isPressed:!1})}onMouseMove(t){if(!this.enabled)return;const i=this.calculateMousePosition(t);this.mouseDelta=i.subtract(this.mousePosition),this.mousePosition=i,this.dispatchEvent("mouse_move",{inputType:e.MOUSE,position:this.mousePosition,delta:this.mouseDelta})}onTouchStart(t){if(this.enabled){t.preventDefault();for(let s=0;s<t.changedTouches.length;s++){const n=t.changedTouches[s],a=this.getTouchPosition(n),o={id:n.identifier,position:a,deltaPosition:_.zero(),startPosition:a.clone(),phase:i.BEGAN,pressure:n.force||1,timestamp:f.totalTime};this.touches.set(n.identifier,o),this.dispatchEvent("touch_start",{inputType:e.TOUCH,touchId:n.identifier,position:a,phase:i.BEGAN})}}}onTouchMove(t){if(this.enabled){t.preventDefault();for(let s=0;s<t.changedTouches.length;s++){const n=t.changedTouches[s],a=this.touches.get(n.identifier);if(!a)continue;const o=this.getTouchPosition(n);a.deltaPosition=o.subtract(a.position),a.position=o,a.phase=i.MOVED,a.timestamp=f.totalTime,this.dispatchEvent("touch_move",{inputType:e.TOUCH,touchId:n.identifier,position:o,delta:a.deltaPosition,phase:i.MOVED})}}}onTouchEnd(t){if(this.enabled){t.preventDefault();for(let s=0;s<t.changedTouches.length;s++){const n=t.changedTouches[s],a=this.touches.get(n.identifier);a&&(a.phase=i.ENDED,a.timestamp=f.totalTime,this.dispatchEvent("touch_end",{inputType:e.TOUCH,touchId:n.identifier,position:a.position,phase:i.ENDED}),this.touches.delete(n.identifier))}}}onTouchCancel(e){if(this.enabled){e.preventDefault();for(let t=0;t<e.changedTouches.length;t++){const i=e.changedTouches[t];this.touches.delete(i.identifier)}}}calculateMousePosition(e){const t=this.canvas.getBoundingClientRect();return new _(e.clientX-t.left,e.clientY-t.top)}getTouchPosition(e){const t=this.canvas.getBoundingClientRect();return new _(e.clientX-t.left,e.clientY-t.top)}isKeyPressed(e){return this.keyStates.get(e)||!1}isKeyJustPressed(e){const t=this.keyStates.get(e)||!1,i=this.previousKeyStates.get(e)||!1;return t&&!i}isKeyJustReleased(e){const t=this.keyStates.get(e)||!1,i=this.previousKeyStates.get(e)||!1;return!t&&i}isMouseButtonPressed(e=t.LEFT){return this.mouseButtons.get(e)||!1}isMouseButtonJustPressed(e=t.LEFT){const i=this.mouseButtons.get(e)||!1,s=this.previousMouseButtons.get(e)||!1;return i&&!s}getMousePosition(){return this.mousePosition.clone()}getMouseDelta(){return this.mouseDelta.clone()}getTouches(){return Array.from(this.touches.values())}getTouchCount(){return this.touches.size}setEnabled(e){this.enabled=e,e||this.clearAllInputs()}isEnabled(){return this.enabled}clearAllInputs(){this.keyStates.clear(),this.mouseButtons.clear(),this.touches.clear(),this.mouseDelta=_.zero()}update(){this.enabled&&(this.previousKeyStates.clear(),this.keyStates.forEach((e,t)=>{this.previousKeyStates.set(t,e)}),this.previousMouseButtons.clear(),this.mouseButtons.forEach((e,t)=>{this.previousMouseButtons.set(t,e)}),this.mouseDelta=_.zero(),this.touches.forEach(e=>{e.phase===i.MOVED&&(e.phase=i.STATIONARY,e.deltaPosition=_.zero())}))}}var C=function(e,t,i,s){return new(i||(i=Promise))(function(n,a){function o(e){try{h(s.next(e))}catch(e){a(e)}}function r(e){try{h(s.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,r)}h((s=s.apply(e,t||[])).next())})};class I extends S{constructor(){super(...arguments),this.resources=new Map,this.loadingPromises=new Map}loadResource(e,t,i){return C(this,void 0,void 0,function*(){const s=this.resources.get(e);if(s){if(s.state===o.LOADED)return s.data;if(s.state===o.LOADING)return this.loadingPromises.get(e);if(s.state===o.ERROR)throw s.error}const n={name:e,url:t,type:i,state:o.LOADING,data:null};this.resources.set(e,n);const a=this.loadResourceByType(n);this.loadingPromises.set(e,a);try{const e=yield a;return n.data=e,n.state=o.LOADED,this.dispatchEvent("resource_loaded",{resource:n}),e}catch(e){throw n.state=o.ERROR,n.error=e,this.dispatchEvent("resource_load_error",{resource:n,error:e}),e}finally{this.loadingPromises.delete(e)}})}loadResourceByType(e){return C(this,void 0,void 0,function*(){const{url:t,type:i}=e;switch(i){case a.IMAGE:return this.loadImage(t);case a.AUDIO:return this.loadAndCheck(t,e=>e.arrayBuffer());case a.TEXT:return this.loadAndCheck(t,e=>e.text());case a.JSON:return this.loadAndCheck(t,e=>e.json());default:throw new Error(`Unsupported resource type: ${i}`)}})}loadAndCheck(e,t){return C(this,void 0,void 0,function*(){const i=yield fetch(e);if(!i.ok)throw new Error(`Failed to load: ${i.status} ${i.statusText}`);return t(i)})}loadImage(e){return C(this,void 0,void 0,function*(){return new Promise((t,i)=>{const s=new Image;s.crossOrigin="anonymous",s.onload=()=>t(s),s.onerror=()=>i(new Error(`Failed to load image: ${e}`)),s.src=e})})}getResource(e){const t=this.resources.get(e);return t&&t.state===o.LOADED?t.data:null}hasResource(e){const t=this.resources.get(e);return void 0!==t&&t.state===o.LOADED}unloadResource(e){this.resources.delete(e)}unloadAll(){this.resources.clear(),this.loadingPromises.clear()}getLoadProgress(){var e;const t=Array.from(this.resources.values()),i=t.length,s=t.filter(e=>e.state===o.LOADED).length;return{totalResources:i,loadedResources:s,failedResources:t.filter(e=>e.state===o.ERROR).length,currentResource:(null===(e=t.find(e=>e.state===o.LOADING))||void 0===e?void 0:e.name)||"",percentage:i>0?s/i*100:100}}}class w extends S{constructor(e){super(),this.enabled=!0,this.destroyed=!1,this.started=!1,this.awoken=!1,this.gameObject=e}getGameObject(){return this.gameObject}getType(){return this.constructor.name}setEnabled(e){const t=this.enabled;this.enabled=e,e&&!t?this.onEnable():!e&&t&&this.onDisable()}isEnabled(){return this.enabled&&this.gameObject.isActive()&&!this.destroyed}setVisible(e){}isVisible(){return this.isEnabled()}awake(){this.awoken||(this.onAwake(),this.awoken=!0)}start(){this.started||(this.onStart(),this.started=!0)}onAwake(){}onStart(){}onEnable(){}onDisable(){}onDestroy(){this.destroyed=!0,this.removeAllEventListeners()}serialize(){return{type:this.getType(),enabled:this.enabled}}deserialize(e){this.enabled="boolean"!=typeof e.enabled||e.enabled}}class P extends w{constructor(e,t=_.zero()){super(e),this.parent=null,this.children=[],this.needsUpdate=!0,this.position=new _(t.x,t.y),this.rotation=0,this.scale=_.one(),this.worldPosition=this.position.clone(),this.worldRotation=0,this.worldScale=_.one()}translate(e){this.position=this.position.add(e),this.markNeedsUpdate()}rotate(e){this.rotation+=e,this.markNeedsUpdate()}setPosition(e){this.position=new _(e.x,e.y),this.markNeedsUpdate()}setRotation(e){this.rotation=e,this.markNeedsUpdate()}setScale(e){this.scale=new _(e.x,e.y),this.markNeedsUpdate()}getWorldPosition(){return this.updateWorldTransform(),this.worldPosition.clone()}getWorldRotation(){return this.updateWorldTransform(),this.worldRotation}getWorldScale(){return this.updateWorldTransform(),this.worldScale.clone()}setParent(e){if(this.parent!==e){if(this.parent){const e=this.parent.children.indexOf(this);-1!==e&&this.parent.children.splice(e,1)}this.parent=e,e&&e.children.push(this),this.markNeedsUpdate()}}getParent(){return this.parent}getChildren(){return[...this.children]}updateWorldTransform(){this.needsUpdate&&(this.parent?(this.parent.updateWorldTransform(),this.worldPosition=this.parent.worldPosition.add(this.position),this.worldRotation=this.parent.worldRotation+this.rotation,this.worldScale=new _(this.parent.worldScale.x*this.scale.x,this.parent.worldScale.y*this.scale.y)):(this.worldPosition=this.position.clone(),this.worldRotation=this.rotation,this.worldScale=this.scale.clone()),this.needsUpdate=!1,this.children.forEach(e=>e.markNeedsUpdate()))}markNeedsUpdate(){this.needsUpdate=!0,this.children.forEach(e=>e.markNeedsUpdate())}update(e){}render(e){}serialize(){return Object.assign(Object.assign({},super.serialize()),{position:{x:this.position.x,y:this.position.y},rotation:this.rotation,scale:{x:this.scale.x,y:this.scale.y}})}deserialize(e){super.deserialize(e),_.isVector2(e.position)&&(this.position=new _(e.position.x,e.position.y)),this.rotation="number"==typeof e.rotation?e.rotation:0,_.isVector2(e.scale)&&(this.scale=new _(e.scale.x,e.scale.y)),this.markNeedsUpdate()}}class M extends S{constructor(e={}){super(),this.components=new Map,this.destroyed=!1,this.active=!0,this.visible=!0,this.started=!1,this.awaken=!1,this.id=this.generateId(),this.name=e.name||`GameObject_${this.id}`,this.tag=e.tag||"Untagged",this.layer=e.layer||0,this.active=!1!==e.active;const t=e.position?new _(e.position.x,e.position.y):_.zero();if(this.addComponent(new P(this,t)),e.rotation||e.scale){const t=this.getTransform();e.rotation&&t.setRotation(e.rotation),e.scale&&t.setScale(e.scale)}}generateId(){return Math.random().toString(36).substr(2,9)+Date.now().toString(36)}addComponent(e){const t=e.getType();return this.components.has(t)&&this.removeComponent(e.constructor),this.components.set(t,e),this.awaken&&e.awake(),this.started&&e.start(),this.dispatchEvent("component_added",{component:e}),e}getComponent(e){const t=e.name;return this.components.get(t)||null}removeComponent(e){const t=e.name,i=this.components.get(t);i&&(i.onDestroy(),this.components.delete(t),this.dispatchEvent("component_removed",{component:i}))}hasComponent(e){const t=e.name;return this.components.has(t)}getAllComponents(){return Array.from(this.components.values())}getTransform(){return this.getComponent(P)}awake(){this.awaken||(this.components.forEach(e=>e.awake()),this.onAwake(),this.awaken=!0)}start(){this.started||(this.components.forEach(e=>e.start()),this.onStart(),this.started=!0)}onAwake(){}onStart(){}onEnable(){this.components.forEach(e=>e.onEnable())}onDisable(){this.components.forEach(e=>e.onDisable())}setActive(e){const t=this.active;this.active=e,e&&!t?(this.onEnable(),this.dispatchEvent("game_object_activated")):!e&&t&&(this.onDisable(),this.dispatchEvent("game_object_deactivated"))}isActive(){return this.active&&!this.destroyed}setEnabled(e){this.setActive(e)}isEnabled(){return this.isActive()}setVisible(e){this.visible=e}isVisible(){return this.visible}getPosition(){return this.getTransform().getWorldPosition()}setPosition(e){this.getTransform().setPosition(e)}getRotation(){return this.getTransform().getWorldRotation()}setRotation(e){this.getTransform().setRotation(e)}translate(e){this.getTransform().translate(e)}rotate(e){this.getTransform().rotate(e)}update(e){this.isActive()&&(this.components.forEach(t=>{t.isEnabled()&&t.update(e)}),this.onUpdate(e))}render(e){this.isActive()&&(this.components.forEach(t=>{t.isVisible()&&t.render(e)}),this.onRender(e))}onUpdate(e){}onRender(e){}destroy(){this.destroyed||(this.destroyed=!0,this.components.forEach(e=>e.onDestroy()),this.components.clear(),this.onDestroy(),this.removeAllEventListeners(),this.dispatchEvent("game_object_destroyed"))}destroyComponent(e){const t=e.name,i=this.components.get(t);i&&(i.onDestroy(),this.components.delete(t))}isDestroyed(){return this.destroyed}onDestroy(){}serialize(){const e={};return this.components.forEach((t,i)=>{e[i]=t.serialize()}),{id:this.id,name:this.name,tag:this.tag,layer:this.layer,active:this.active,components:e}}deserialize(e){"string"==typeof e.name&&(this.name=e.name),"string"==typeof e.tag&&(this.tag=e.tag),"number"==typeof e.layer&&(this.layer=e.layer),this.active=!1!==e.active,e.components&&"object"==typeof e.components&&null!==e.components&&this.components.forEach((t,i)=>{Object.prototype.hasOwnProperty.call(e.components,i)&&e.components[i]&&t.deserialize(e.components[i])})}static createEmpty(e){return new M({name:e})}static createWithTransform(e,t,i){return new M({position:e,rotation:t,scale:i})}}const L={PLAYER:{WIDTH:32,HEIGHT:32,JUMP_FORCE:-800,MOVE_SPEED:600,MAX_FALL_SPEED:2200},DECORATION:{WIDTH:64,HEIGHT:120},PLATFORM:{WIDTH:196,HEIGHT:64,SPAWN_DISTANCE:96,INITIAL_COUNT:10},OBSTACLES:{LANDED_SPIKE:{ICON:"landed_spike",SPAWN_CHANCE:.1,WIDTH:96,HEIGHT:24,SPAWN_LEVEL:1},FLYING_MONSTER:{ICON:"flying_monster",SPAWN_CHANCE:.1,WIDTH:96,HEIGHT:96,MOVE_SPEED:400,SPAWN_LEVEL:1},WITCH:{ICON:"witch",SPAWN_CHANCE:.1,WIDTH:128,HEIGHT:128,MOVE_SPEED:200,MOVE_RANGE:400,SPAWN_LEVEL:3}},ITEMS:{TRAMPOLINE:{ICON:"trampoline",SPAWN_CHANCE:.5,WIDTH:64,HEIGHT:64,BOUNCE_FORCE:1200},JETPACK:{ICON:"jetpack",SPAWN_CHANCE:.5,WIDTH:64,HEIGHT:64,FUEL:25,FUEL_CONSUMPTION_RATE:10}},BACKGROUND:{CLOUD:{WIDTH:200,HEIGHT:100,MOVE_SPEED:50,COUNT:5}},IMAGES:{BACKGROUND:{GAMEPLAY_BACKGROUND:"gameplay_background",MAINMENU_BACKGROUND:"main_menu_background"},BUTTON:{PLAY_BUTTON:"play_button",SETTINGS_BUTTON:"settings_button",BACK_BUTTON:"back_button",RESTART_BUTTON:"restart_button",SOUND_ON_BUTTON:"sound_on_button",SOUND_OFF_BUTTON:"sound_off_button"},CLOUD:"cloud",PLATFORMS:{PLATFORM_1:"platform_1",PLATFORM_2:"platform_2",PLATFORM_3:"platform_3",PLATFORM_4:"platform_4",PLATFORM_5:"platform_5"},DECORATIONS:{TREE_1:"tree_1",TREE_2:"tree_2",TREE_3:"tree_3",TREE_4:"tree_4",LAMP_POST_1:"lamp_post_1",LAMP_POST_2:"lamp_post_2"},GROUND:"ground",PLAYERS:{PLAYER_IDLE:"player_idle",PLAYER_MOVE_LEFT:"player_move_left",PLAYER_MOVE_RIGHT:"player_move_right",PLAYER_JUMP:"player_jump",PLAYER_IDLE_JETPACK:"player_idle_jetpack",PLAYER_MOVE_LEFT_JETPACK:"player_move_left_jetpack",PLAYER_MOVE_RIGHT_JETPACK:"player_move_right_jetpack",PLAYER_DEAD:"player_dead"}},AUDIO:{SFX:{TRAMPOLINE:"trampoline",JUMP:"jump",JETPACK:"jetpack",HIT:"hit",WALK:"walk",BUTTON_CLICK:"button_click"},MUSIC:{BACKGROUND_MUSIC:"background_music"}},ANIMATIONS:{PLAYER_IDLE:{name:"player_idle",frames:["player_idle_1","player_idle_2","player_idle_3","player_idle_4","player_idle_5","player_idle_6"],frameRate:500,loop:!0},PLAYER_IDLE_JETPACK:{name:"player_idle_jetpack",frames:["player_idle_jetpack_1","player_idle_jetpack_2","player_idle_jetpack_3","player_idle_jetpack_4","player_idle_jetpack_5","player_idle_jetpack_6"],frameRate:500,loop:!0},PLAYER_MOVE_LEFT:{name:"player_move_left",frames:["player_move_left_1","player_move_left_2","player_move_left_3","player_move_left_4"],frameRate:300,loop:!0},PLAYER_MOVE_LEFT_JETPACK:{name:"player_move_left_jetpack",frames:["player_move_left_jetpack_1","player_move_left_jetpack_2","player_move_left_jetpack_3","player_move_left_jetpack_4"],frameRate:300,loop:!0},PLAYER_MOVE_RIGHT:{name:"player_move_right",frames:["player_move_right_1","player_move_right_2","player_move_right_3","player_move_right_4"],frameRate:300,loop:!0},PLAYER_MOVE_RIGHT_JETPACK:{name:"player_move_right_jetpack",frames:["player_move_right_jetpack_1","player_move_right_jetpack_2","player_move_right_jetpack_3","player_move_right_jetpack_4"],frameRate:300,loop:!0},PLAYER_JUMP:{name:"player_jump",frames:["player_jump_1","player_jump_2","player_jump_3"],frameRate:300,loop:!1},PLAYER_DEAD:{name:"player_dead",frames:["player_dead","player_dead","player_dead"],frameRate:300,loop:!1}},DIFFICULTY:500,HIGH_SCORE_KEY:"doodleJump_highScore",CURRENT_SCORE_KEY:"doodleJump_currentScore",AUDIO_ENABLED_KEY:"doodleJump_audioEnabled"};class R{static clamp(e,t,i){return Math.max(t,Math.min(i,e))}static clamp01(e){return this.clamp(e,0,1)}static lerp(e,t,i){return e+(t-e)*this.clamp01(i)}static lerpUnclamped(e,t,i){return e+(t-e)*i}static inverseLerp(e,t,i){return e!==t?this.clamp01((i-e)/(t-e)):0}static smoothStep(e,t,i){return i=(i=this.clamp01(i))*i*(3-2*i),this.lerp(e,t,i)}static pingPong(e,t){return e%=2*t,t-Math.abs(e-t)}static repeat(e,t){return e-Math.floor(e/t)*t}static sign(e){return e>=0?1:-1}static distance(e,t,i,s){const n=i-e,a=s-t;return Math.sqrt(n*n+a*a)}static sqrDistance(e,t,i,s){const n=i-e,a=s-t;return n*n+a*a}static random(e,t){return void 0===e&&void 0===t?Math.random():void 0===t?Math.random()*e:Math.random()*(t-e)+e}static randomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}static randomSign(){return Math.random()<.5?-1:1}static randomBool(){return Math.random()<.5}static randomChoice(e){return e[this.randomInt(0,e.length-1)]}static shuffle(e){const t=[...e];for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t}static degToRad(e){return e*this.DEG_TO_RAD}static radToDeg(e){return e*this.RAD_TO_DEG}static isPowerOfTwo(e){return!(e&e-1)&&0!==e}static nextPowerOfTwo(e){return Math.pow(2,Math.ceil(Math.log2(e)))}static map(e,t,i,s,n){return s+(e-t)/(i-t)*(n-s)}static approximately(e,t,i=1e-4){return Math.abs(e-t)<i}}R.PI=Math.PI,R.TWO_PI=2*Math.PI,R.HALF_PI=.5*Math.PI,R.DEG_TO_RAD=Math.PI/180,R.RAD_TO_DEG=180/Math.PI;class D{constructor(e=255,t=255,i=255,s=1){this.r=R.clamp(e,0,255),this.g=R.clamp(t,0,255),this.b=R.clamp(i,0,255),this.a=R.clamp(s,0,1)}clone(){return new D(this.r,this.g,this.b,this.a)}set(e,t=1){return this.r=R.clamp(e.r,0,255),this.g=R.clamp(e.g,0,255),this.b=R.clamp(e.b,0,255),this.a=R.clamp(t,0,1),this}toString(){return`rgba(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)}, ${this.a})`}toHex(){const e=e=>{const t=Math.round(e).toString(16);return 1===t.length?"0"+t:t};return`#${e(this.r)}${e(this.g)}${e(this.b)}`}toHSL(){const e=this.r/255,t=this.g/255,i=this.b/255,s=Math.max(e,t,i),n=Math.min(e,t,i);let a,o;const r=(s+n)/2;if(s===n)a=o=0;else{const h=s-n;switch(o=r>.5?h/(2-s-n):h/(s+n),s){case e:a=(t-i)/h+(t<i?6:0);break;case t:a=(i-e)/h+2;break;case i:a=(e-t)/h+4;break;default:a=0}a/=6}return{h:360*a,s:100*o,l:100*r}}lerp(e,t){return t=R.clamp01(t),new D(R.lerp(this.r,e.r,t),R.lerp(this.g,e.g,t),R.lerp(this.b,e.b,t),R.lerp(this.a,e.a,t))}multiply(e){return new D(this.r*e.r/255,this.g*e.g/255,this.b*e.b/255,this.a*e.a)}add(e){return new D(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static fromHex(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?new D(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new D}static fromHSL(e,t=1){e.h=e.h/360,e.s=e.s/100,e.l=e.l/100;const i=(e,t,i)=>(i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e);let s,n,a;if(0===e.s)s=n=a=e.l;else{const t=e.l<.5?e.l*(1+e.s):e.l+e.s-e.l*e.s,o=2*e.l-t;s=i(o,t,e.h+1/3),n=i(o,t,e.h),a=i(o,t,e.h-1/3)}return new D(255*s,255*n,255*a,t)}static lerp(e,t,i){return e.lerp(t,i)}static isRGBAColor(e){return"object"==typeof e&&null!==e&&"number"==typeof e.r&&"number"==typeof e.g&&"number"==typeof e.b&&"number"==typeof e.a}}D.WHITE=new D(255,255,255),D.BLACK=new D(0,0,0),D.RED=new D(255,0,0),D.GREEN=new D(0,255,0),D.BLUE=new D(0,0,255),D.YELLOW=new D(255,255,0),D.CYAN=new D(0,255,255),D.MAGENTA=new D(255,0,255),D.ORANGE=new D(255,165,0),D.PURPLE=new D(128,0,128),D.PINK=new D(255,192,203),D.BROWN=new D(165,42,42),D.GRAY=new D(128,128,128),D.LIGHT_GRAY=new D(211,211,211),D.DARK_GRAY=new D(64,64,64),D.TRANSPARENT=new D(0,0,0,0),D.AQUA=new D(0,255,255),D.LIME=new D(0,255,0),D.NAVY=new D(0,0,128),D.TEAL=new D(0,128,128),D.OLIVE=new D(128,128,0),D.SILVER=new D(192,192,192),D.GOLD=new D(255,215,0),D.INDIGO=new D(75,0,130),D.VIOLET=new D(238,130,238),D.MAROON=new D(128,0,0),D.CORAL=new D(255,127,80),D.SALMON=new D(250,128,114),D.SKY_BLUE=new D(135,206,235),D.GOLDENROD=new D(218,165,32),D.DARK_RED=new D(139,0,0),D.DARK_GREEN=new D(0,100,0),D.DARK_BLUE=new D(0,0,139),D.DARK_ORANGE=new D(255,140,0),D.DARK_CYAN=new D(0,139,139),D.DARK_MAGENTA=new D(139,0,139),D.DARK_YELLOW=new D(128,128,0),D.LIGHT_BLUE=new D(173,216,230),D.LIGHT_GREEN=new D(144,238,144),D.LIGHT_PINK=new D(255,182,193),D.LIGHT_YELLOW=new D(255,255,224),D.LIGHT_ORANGE=new D(255,228,181),D.LIGHT_PURPLE=new D(221,160,221),D.LIGHT_BROWN=new D(210,180,140);class x extends w{constructor(e){super(e),this.anchor=d.TOP_LEFT,this.pivot=_.zero(),this.size=new _(100,50),this.margin={top:0,right:0,bottom:0,left:0},this.padding={top:5,right:5,bottom:5,left:5},this.parent=null,this.children=[],this.canvas=null,this.canvasSize=_.zero()}setCanvas(e){this.canvas=e,this.canvasSize=new _(e.width,e.height)}addChild(e){if(!(e instanceof x))throw new Error("Child must be an instance of UIElement");e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e),this.canvas&&e.setCanvas(this.canvas)}removeChild(e){if(!(e instanceof x))throw new Error("Child must be an instance of UIElement");const t=this.children.indexOf(e);-1!==t&&(e.parent=null,this.children.splice(t,1))}getParent(){return this.parent}getChildren(){if(0===this.children.length)return[];const e=[];return this.children.forEach(t=>{e.push(t)}),e}setLocalPosition(e){const t=this.gameObject.getComponent(P);t&&t.setPosition(e)}setAnchor(e){this.anchor=e}setPivot(e){this.pivot=new _(e.x,e.y)}getWorldBounds(){const e=this.getWorldPosition(),t=new _(this.size.x*this.pivot.x,this.size.y*this.pivot.y);return{x:e.x-t.x,y:e.y-t.y,width:this.size.x,height:this.size.y}}getWorldPosition(){let e=_.zero();if(this.parent){const t=this.parent.getWorldBounds(),i=this.getAnchorPosition(this.anchor,t),s=this.gameObject.getComponent(P),n=s?s.position:_.zero();e=i.add(n)}else if(this.canvas){const t=this.getAnchorPosition(this.anchor,{x:0,y:0,width:this.canvas.width,height:this.canvas.height}),i=this.gameObject.getComponent(P),s=i?i.position:_.zero();e=t.add(s)}return e}getAnchorPosition(e,t){switch(e){case d.TOP_LEFT:return new _(t.x,t.y);case d.TOP_CENTER:return new _(t.x+t.width/2,t.y);case d.TOP_RIGHT:return new _(t.x+t.width,t.y);case d.MIDDLE_LEFT:return new _(t.x,t.y+t.height/2);case d.MIDDLE_CENTER:return new _(t.x,t.y);case d.MIDDLE_RIGHT:return new _(t.x+t.width,t.y+t.height/2);case d.BOTTOM_LEFT:return new _(t.x,t.y+t.height);case d.BOTTOM_CENTER:return new _(t.x+t.width/2,t.y+t.height);case d.BOTTOM_RIGHT:return new _(t.x+t.width,t.y+t.height);default:return new _(t.x,t.y)}}update(e){this.children.forEach(t=>{t.isEnabled()&&t.update(e)})}render(e){this.isVisible()&&(this.onRender(e),this.children.forEach(t=>{t.isVisible()&&t.render(e)}))}onRender(e){}serialize(){return Object.assign(Object.assign({},super.serialize()),{anchor:this.anchor,pivot:this.pivot,size:this.size,margin:this.margin,padding:this.padding})}deserialize(e){super.deserialize(e),this.anchor=e.anchor||d.TOP_LEFT,_.isVector2(e.pivot)&&(this.pivot=new _(e.pivot.x,e.pivot.y)),_.isVector2(e.size)&&(this.size=new _(e.size.x,e.size.y))}}class N extends x{constructor(e,t=""){super(e),this.text="",this.font="16px Arial",this.color=D.WHITE,this.textAlign="left",this.textBaseline="top",this.wordWrap=!1,this.lineHeight=1.2,this.text=t}setText(e){this.text=e}setFont(e){this.font=e}setColor(e){this.color=e}setTextAlign(e){this.textAlign=e}setTextBaseline(e){this.textBaseline=e}onRender(e){if(!this.text)return;const t=this.getWorldBounds();if(e.save(),e.font=this.font,e.fillStyle=new D(this.color.r,this.color.g,this.color.b,this.color.a).toString(),e.textAlign=this.textAlign,e.textBaseline=this.textBaseline,this.wordWrap)this.renderWrappedText(e,t);else{const i=this.getTextX(t),s=this.getTextY(t);e.fillText(this.text,i,s)}e.restore()}renderWrappedText(e,t){const i=this.text.split(" "),s=[];let n="";for(const a of i){const i=n+(n?" ":"")+a;e.measureText(i).width>t.width-this.padding.left-this.padding.right&&n?(s.push(n),n=a):n=i}n&&s.push(n);const a=parseInt(this.font)*this.lineHeight;let o=t.y+this.padding.top;"middle"===this.textBaseline?o=t.y+t.height/2-s.length*a/2:"bottom"===this.textBaseline&&(o=t.y+t.height-this.padding.bottom-s.length*a),s.forEach((i,s)=>{const n=this.getTextX(t),r=o+s*a;e.fillText(i,n,r)})}getTextX(e){switch(this.textAlign){case"left":default:return e.x+this.padding.left;case"center":return e.x+e.width;case"right":return e.x+e.width-this.padding.right}}getTextY(e){switch(this.textBaseline){case"top":default:return e.y+this.padding.top;case"middle":return e.y+e.height/2+this.padding.top-this.padding.bottom+8;case"bottom":return e.y+e.height-this.padding.bottom}}serialize(){return Object.assign(Object.assign({},super.serialize()),{text:this.text,font:this.font,color:this.color,textAlign:this.textAlign,textBaseline:this.textBaseline,wordWrap:this.wordWrap,lineHeight:this.lineHeight})}deserialize(e){super.deserialize(e),"string"==typeof e.text&&(this.text=e.text),"string"==typeof e.font&&(this.font=e.font),D.isRGBAColor(e.color)&&(this.color=e.color),"string"==typeof e.textAlign&&(this.textAlign=e.textAlign),"string"==typeof e.textBaseline&&(this.textBaseline=e.textBaseline),"boolean"==typeof e.wordWrap&&(this.wordWrap=e.wordWrap),"number"==typeof e.lineHeight&&(this.lineHeight=e.lineHeight)}}class G extends x{constructor(e){super(e),this.backgroundColor=D.DARK_GRAY,this.borderColor=D.GRAY,this.borderWidth=1,this.cornerRadius=5,this.alpha=1}setBackgroundColor(e){this.backgroundColor=e}setBorderColor(e){this.borderColor=e}setBorderWidth(e){this.borderWidth=e}setCornerRadius(e){this.cornerRadius=e}onRender(e){const t=this.getWorldBounds();e.save(),e.globalAlpha=this.alpha,this.cornerRadius>0?(this.drawRoundedRect(e,t,this.cornerRadius),e.fillStyle=new D(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a).toString(),e.fill()):(e.fillStyle=new D(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a).toString(),e.fillRect(t.x,t.y,t.width,t.height)),this.borderWidth>0&&(this.cornerRadius>0?this.drawRoundedRect(e,t,this.cornerRadius):e.rect(t.x,t.y,t.width,t.height),e.strokeStyle=new D(this.borderColor.r,this.borderColor.g,this.borderColor.b,this.borderColor.a).toString(),e.lineWidth=this.borderWidth,e.stroke()),e.restore()}drawRoundedRect(e,t,i){e.beginPath(),e.moveTo(t.x+i,t.y),e.lineTo(t.x+t.width-i,t.y),e.quadraticCurveTo(t.x+t.width,t.y,t.x+t.width,t.y+i),e.lineTo(t.x+t.width,t.y+t.height-i),e.quadraticCurveTo(t.x+t.width,t.y+t.height,t.x+t.width-i,t.y+t.height),e.lineTo(t.x+i,t.y+t.height),e.quadraticCurveTo(t.x,t.y+t.height,t.x,t.y+t.height-i),e.lineTo(t.x,t.y+i),e.quadraticCurveTo(t.x,t.y,t.x+i,t.y),e.closePath()}serialize(){return Object.assign(Object.assign({},super.serialize()),{backgroundColor:this.backgroundColor,borderColor:this.borderColor,borderWidth:this.borderWidth,cornerRadius:this.cornerRadius,alpha:this.alpha})}deserialize(e){super.deserialize(e),D.isRGBAColor(e.backgroundColor)&&(this.backgroundColor=e.backgroundColor),D.isRGBAColor(e.borderColor)&&(this.borderColor=e.borderColor),"number"==typeof e.borderWidth&&(this.borderWidth=e.borderWidth),"number"==typeof e.cornerRadius&&(this.cornerRadius=e.cornerRadius),"number"==typeof e.alpha&&(this.alpha=e.alpha)}}class B extends G{constructor(e,t="Button"){super(e),this.label=null,this.state=u.NORMAL,this.normalColor=D.GRAY,this.hoverColor=D.LIGHT_GRAY,this.pressedColor=D.DARK_GRAY,this.disabledColor=new D(64,64,64,128),this.normalTextColor=D.WHITE,this.hoverTextColor=D.WHITE,this.pressedTextColor=D.LIGHT_GRAY,this.disabledTextColor=D.DARK_GRAY,this.onClick=null,this.onHover=null,this.onPress=null,this.onRelease=null,this.isMouseOver=!1,this.isMouseDown=!1;const i=new M({name:"ButtonLabel",position:new _(0,0)}),s=new N(i,t);s.textAlign="center",s.textBaseline="middle",this.label=s,this.anchor=d.MIDDLE_CENTER,this.addChild(this.label),this.updateAppearance()}setText(e){this.label&&this.label.setText(e)}setOnClick(e){this.onClick=e}setOnHover(e){this.onHover=e}setOnPress(e){this.onPress=e}setOnRelease(e){this.onRelease=e}setColors(e,t,i){this.normalColor=e,this.normalTextColor=t,this.hoverColor=i,this.updateAppearance()}setEnabled(e){super.setEnabled(e),this.state=e?u.NORMAL:u.DISABLED,this.updateAppearance()}handleMouseMove(e){var t;if(!this.isEnabled())return;const i=this.getWorldBounds(),s=this.isMouseOver;this.isMouseOver=e.x>=i.x&&e.x<=i.x+i.width&&e.y>=i.y&&e.y<=i.y+i.height,this.isMouseOver&&!s?(this.state=this.isMouseDown?u.PRESSED:u.HOVERED,null===(t=this.onHover)||void 0===t||t.call(this)):!this.isMouseOver&&s&&(this.state=u.NORMAL),this.updateAppearance()}handleMouseDown(e){var t;this.isEnabled()&&this.isMouseOver&&(this.isMouseDown=!0,this.state=u.PRESSED,null===(t=this.onPress)||void 0===t||t.call(this),this.updateAppearance(),j.getInstance().getAudioManager().playSound(L.AUDIO.SFX.BUTTON_CLICK))}handleMouseUp(e){var t,i;if(!this.isEnabled())return;const s=this.isMouseDown;this.isMouseDown=!1,s&&this.isMouseOver&&(null===(t=this.onClick)||void 0===t||t.call(this)),this.state=this.isMouseOver?u.HOVERED:u.NORMAL,null===(i=this.onRelease)||void 0===i||i.call(this),this.updateAppearance()}updateAppearance(){switch(this.state){case u.NORMAL:this.backgroundColor=this.normalColor,this.label&&(this.label.color=this.normalTextColor);break;case u.HOVERED:this.backgroundColor=this.hoverColor,this.label&&(this.label.color=this.hoverTextColor);break;case u.PRESSED:this.backgroundColor=this.pressedColor,this.label&&(this.label.color=this.pressedTextColor);break;case u.DISABLED:this.backgroundColor=this.disabledColor,this.label&&(this.label.color=this.disabledTextColor)}}serialize(){return Object.assign(Object.assign({},super.serialize()),{state:this.state,normalColor:this.normalColor,hoverColor:this.hoverColor,pressedColor:this.pressedColor,disabledColor:this.disabledColor,normalTextColor:this.normalTextColor,hoverTextColor:this.hoverTextColor,pressedTextColor:this.pressedTextColor,disabledTextColor:this.disabledTextColor})}deserialize(e){super.deserialize(e),"string"==typeof e.state&&(this.state=e.state),D.isRGBAColor(e.normalColor)&&(this.normalColor=e.normalColor),D.isRGBAColor(e.hoverColor)&&(this.hoverColor=e.hoverColor),this.updateAppearance()}}class k extends S{constructor(e){super(),this.rootElements=[],this.canvas=e,this.setupEventListeners()}setupEventListeners(){this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this))}addRootElement(e){e.setCanvas(this.canvas),this.rootElements.push(e)}removeRootElement(e){const t=this.rootElements.indexOf(e);-1!==t&&this.rootElements.splice(t,1)}update(e){this.rootElements.forEach(t=>{t.isEnabled()&&t.update(e)})}render(e){this.rootElements.forEach(t=>{t.isVisible()&&t.render(e)})}handleMouseMove(e){const t=this.canvas.getBoundingClientRect(),i=new _(e.clientX-t.left,e.clientY-t.top);this.processUIElements(this.rootElements,e=>{e instanceof B&&e.handleMouseMove(i)})}handleMouseDown(e){const t=this.canvas.getBoundingClientRect(),i=new _(e.clientX-t.left,e.clientY-t.top);this.processUIElements(this.rootElements,e=>{e instanceof B&&e.handleMouseDown(i)})}handleMouseUp(e){const t=this.canvas.getBoundingClientRect(),i=new _(e.clientX-t.left,e.clientY-t.top);this.processUIElements(this.rootElements,e=>{e instanceof B&&e.handleMouseUp(i)})}processUIElements(e,t){e.forEach(e=>{t(e),this.processUIElements(e.getChildren(),t)})}}class j extends S{constructor(e){if(super(),this.scenes=new Map,this.currentScene=null,this.isRunning=!1,this.isPaused=!1,this.lastTime=0,this.targetFPS=60,this.frameTime=1e3/this.targetFPS,this.frameCount=0,this.fpsCounter=0,this.lastFpsUpdate=0,this.canvas=document.getElementById(e.canvasId),!this.canvas)throw new Error(`Canvas with id '${e.canvasId}' not found`);if(this.ctx=this.canvas.getContext("2d"),!this.ctx)throw new Error("Could not get 2D context from canvas");this.setupCanvas(e.width||800,e.height||600),this.initializeSystems(),e.targetFPS&&this.setTargetFPS(e.targetFPS),j.instance||(j.instance=this),this.dispatchEvent("engine_initialized")}static getInstance(){if(!j.instance)throw new Error("GameEngine has not been initialized. Please create an instance first.");return j.instance}setupCanvas(e,t){this.canvas.width=e,this.canvas.height=t,this.canvas.addEventListener("contextmenu",e=>e.preventDefault()),this.canvas.tabIndex=1e3,this.canvas.style.display="block",this.canvas.style.margin="auto",this.canvas.style.border="1px solid #333",document.body.style.display="flex",document.body.style.justifyContent="center",document.body.style.alignItems="center",document.body.style.margin="0"}initializeSystems(){this.inputManager=new v(this.canvas),this.audioManager=new T,this.resourceManager=new I,this.collisionManager=new O,this.uiManager=new k(this.canvas)}addScene(e,t){this.scenes.set(e,t),this.dispatchEvent("scene_added",{name:e,scene:t})}setScene(e){return t=this,i=void 0,n=function*(){const t=this.scenes.get(e);if(!t)throw new Error(`Scene '${e}' not found`);this.currentScene&&(yield this.currentScene.unload(),this.collisionManager.clear()),this.currentScene=t,yield this.currentScene.load(),this.dispatchEvent("scene_changed",{name:e,scene:t})},new((s=void 0)||(s=Promise))(function(e,a){function o(e){try{h(n.next(e))}catch(e){a(e)}}function r(e){try{h(n.throw(e))}catch(e){a(e)}}function h(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s(function(e){e(i)})).then(o,r)}h((n=n.apply(t,i||[])).next())});var t,i,s,n}getCurrentScene(){return this.currentScene}start(){this.isRunning||(this.isRunning=!0,this.isPaused=!1,this.lastTime=performance.now(),f.reset(),this.gameLoop(this.lastTime),this.dispatchEvent("engine_started"))}stop(){this.isRunning=!1,this.dispatchEvent("engine_stopped")}pause(){this.isPaused=!0,this.dispatchEvent("engine_paused")}resume(){this.isPaused=!1,this.lastTime=performance.now(),this.dispatchEvent("engine_resumed")}gameLoop(e){if(!this.isRunning)return;let t=e-this.lastTime;this.lastTime=e,t=Math.min(t,2*this.frameTime),f.update(t),this.isPaused||(this.update(t),this.render()),this.updatePerformanceStats(),requestAnimationFrame(e=>this.gameLoop(e))}update(e){this.inputManager.update(),this.currentScene&&this.currentScene.update(e),this.collisionManager.checkCollisions(),this.dispatchEvent("engine_updated",{deltaTime:e})}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentScene&&this.currentScene.render(this.ctx),this.dispatchEvent("engine_rendered")}updatePerformanceStats(){this.frameCount++;const e=f.totalTime;e-this.lastFpsUpdate>=1e3&&(this.fpsCounter=Math.round(1e3*this.frameCount/(e-this.lastFpsUpdate)),this.frameCount=0,this.lastFpsUpdate=e)}getInputManager(){return this.inputManager}getAudioManager(){return this.audioManager}getResourceManager(){return this.resourceManager}getCollisionManager(){return this.collisionManager}getUIManager(){return this.uiManager}getCanvas(){return this.canvas}getContext(){return this.ctx}setTargetFPS(e){this.targetFPS=Math.max(1,e),this.frameTime=1e3/this.targetFPS}getTargetFPS(){return this.targetFPS}getCurrentFPS(){return this.fpsCounter}destroy(){this.stop(),this.currentScene&&this.currentScene.unload(),this.scenes.clear(),this.collisionManager.clear(),this.resourceManager.unloadAll(),this.audioManager.stopAllSounds(),this.removeAllEventListeners(),this.dispatchEvent("engine_destroyed")}}j.instance=null;const H=1e3,U=800,F=200,Y="Space",W="ArrowLeft",V="ArrowUp",z="ArrowRight",K="KeyA",J="KeyD",X="KeyW";var $=function(e,t,i,s){return new(i||(i=Promise))(function(n,a){function o(e){try{h(s.next(e))}catch(e){a(e)}}function r(e){try{h(s.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,r)}h((s=s.apply(e,t||[])).next())})};class q{static start(e){var t,i,s,n,a;return $(this,void 0,void 0,function*(){let o=document.getElementById(null!==(t=e.canvasId)&&void 0!==t?t:"game-canvas");if(o||(o=document.createElement("canvas"),o.id=null!==(i=e.canvasId)&&void 0!==i?i:"game-canvas",document.body.appendChild(o)),this.engine=new j({canvasId:o.id,width:null!==(s=e.width)&&void 0!==s?s:H,height:null!==(n=e.height)&&void 0!==n?n:H,targetFPS:null!==(a=e.targetFPS)&&void 0!==a?a:60}),e.preloadAssets&&(yield this.preloadAssets(e.preloadAssets)),e.scenes){for(const t of e.scenes)this.engine.addScene(t.getName(),t);yield this.engine.setScene(e.scenes[0].getName())}this.engine.start()})}static getEngine(){return this.engine}static preloadAssets(e){return $(this,void 0,void 0,function*(){const t=this.engine.getResourceManager(),i=this.engine.getAudioManager();if(e.images)for(const i of e.images)yield t.loadResource(i.name,i.url,a.IMAGE);if(e.audio)for(const t of e.audio)yield i.loadSound(t.name,t.url)})}static addScene(e,t){this.engine.addScene(e,t)}static setScene(e){return $(this,void 0,void 0,function*(){yield this.engine.setScene(e)})}}class Q extends w{setFlip(e,t){this.scaleX=e,this.scaleY=t}constructor(e){super(e),this.color=D.WHITE,this.visible=!0,this.scaleX=1,this.scaleY=1,this.image=null,this.imageWidth=null,this.imageHeight=null}setImage(e){this.image=e}setColor(e){this.color=e}setVisible(e){this.visible=e}isVisible(){return this.visible&&this.isEnabled()}setImageSize(e,t){this.imageWidth=e,this.imageHeight=t}getWidth(){var e;return null!==(e=this.imageWidth)&&void 0!==e?e:this.image?this.image.width:50}getHeight(){var e;return null!==(e=this.imageHeight)&&void 0!==e?e:this.image?this.image.height:50}update(e){}render(e){var t,i;if(!this.isVisible())return;const s=this.gameObject.getComponent(P);if(!s)return;e.save();const n=s.getWorldPosition(),a=s.getWorldRotation(),o=s.getWorldScale();if(e.translate(n.x,n.y),e.rotate(a),e.scale(o.x*this.scaleX,o.y*this.scaleY),this.image){const s=null!==(t=this.imageWidth)&&void 0!==t?t:this.image.width,n=null!==(i=this.imageHeight)&&void 0!==i?i:this.image.height;e.drawImage(this.image,-s/2,-n/2,s,n)}else e.fillStyle=new D(this.color.r,this.color.g,this.color.b,this.color.a).toString(),e.fillRect(-25,-25,50,50);e.restore()}serialize(){return Object.assign(Object.assign({},super.serialize()),{color:this.color,visible:this.visible})}deserialize(e){super.deserialize(e),D.isRGBAColor(e.color)&&(this.color={r:e.color.r,g:e.color.g,b:e.color.b,a:e.color.a}),this.visible=!1!==e.visible}}class Z extends Q{constructor(e){super(e),this.animations=new Map,this.currentAnimation=null,this.currentFrame=0,this.animationTime=0}addAnimation(e,t,i,s=100,n=!0){const a=i.getResourceManager(),o=[];for(const e of t){const t=a.getResource(e);t&&o.push(t)}this.animations.set(e,{name:e,frames:o,frameTime:s,loop:n,currentFrame:0})}playAnimation(e){const t=this.animations.get(e);t&&t!==this.currentAnimation&&(this.currentAnimation=t,this.currentFrame=0,this.animationTime=0,this.imageWidth=this.currentAnimation.frames[this.currentFrame].width,this.imageHeight=this.currentAnimation.frames[this.currentFrame].height)}update(e){super.update(e),this.currentAnimation&&(this.animationTime+=e,this.animationTime>=this.currentAnimation.frameTime&&(this.currentFrame++,this.animationTime=0,this.currentFrame>=this.currentAnimation.frames.length&&(this.currentAnimation.loop?this.currentFrame=0:this.currentFrame=this.currentAnimation.frames.length-1)))}render(e){if(!this.isVisible())return;const t=this.gameObject.getComponent(P);if(!t)return;e.save();const i=t.getWorldPosition(),s=t.getWorldRotation(),n=t.getWorldScale();if(e.translate(i.x,i.y),e.rotate(s),e.scale(n.x,n.y),this.currentAnimation&&this.currentAnimation.frames.length>0){const t=this.currentAnimation.frames[this.currentFrame];e.drawImage(t,-t.width/2,-t.height/2)}else this.image&&e.drawImage(this.image,-this.image.width/2,-this.image.height/2);e.restore()}}class ee{constructor(e){var t,i,s;this.isAlive=!0,this.position=new _(e.position.x,e.position.y),this.velocity=e.velocity?new _(e.velocity.x,e.velocity.y):_.zero(),this.acceleration=e.acceleration?new _(e.acceleration.x,e.acceleration.y):_.zero(),this.life=e.life,this.maxLife=e.life,this.size=e.size,this.originalSize=e.size,this.color=Object.assign({},e.color),this.fadeOut=null===(t=e.fadeOut)||void 0===t||t,this.shrink=null!==(i=e.shrink)&&void 0!==i&&i,this.gravity=null!==(s=e.gravity)&&void 0!==s&&s}update(e){if(!this.isAlive)return;const t=e/1e3;if(this.gravity&&(this.acceleration.y+=500*t),this.velocity=this.velocity.add(this.acceleration.multiply(t)),this.position=this.position.add(this.velocity.multiply(t)),this.life-=e,this.life<=0)return void(this.isAlive=!1);const i=this.life/this.maxLife;this.fadeOut&&(this.color.a=i),this.shrink&&(this.size=this.originalSize*i),this.acceleration=_.zero()}render(e){this.isAlive&&(e.save(),e.globalAlpha=this.color.a,e.fillStyle=new D(this.color.r,this.color.g,this.color.b,this.color.a).toString(),e.beginPath(),e.arc(this.position.x,this.position.y,this.size,0,2*Math.PI),e.fill(),e.restore())}}class te extends w{constructor(e,t=1e3){super(e),this.particles=[],this.maxParticles=1e3,this.maxParticles=t}emit(e){this.particles.length>=this.maxParticles&&this.particles.shift();const t=new ee(e);this.particles.push(t)}emitBurst(e,t,i){for(let s=0;s<t;s++){const t=this.getPresetConfig(e,i);this.emit(t)}}emitExplosion(e,t=30){this.emitBurst(e,t,y.EXPLOSION)}emitStars(e,t=20){this.emitBurst(e,t,y.STARS)}emitSparkles(e,t=15){this.emitBurst(e,t,y.SPARKLES)}emitConfetti(e,t=50){this.emitBurst(e,t,y.CONFETTI)}emitHearts(e,t=10){this.emitBurst(e,t,y.HEARTS)}getPresetConfig(e,t){const i=R.random(0,2*Math.PI),s=R.random(50,200),n=_.fromAngle(i,s);switch(t){case y.EXPLOSION:return{position:e,velocity:n,life:R.random(500,1500),size:R.random(3,8),color:{r:R.random(200,255),g:R.random(100,200),b:R.random(0,100),a:1},fadeOut:!0,shrink:!0,gravity:!0};case y.STARS:return{position:e,velocity:_.fromAngle(i,R.random(30,100)),life:R.random(1e3,2e3),size:R.random(2,5),color:{r:255,g:255,b:R.random(200,255),a:1},fadeOut:!0,shrink:!1,gravity:!1};case y.SPARKLES:return{position:new _(e.x+R.random(-20,20),e.y+R.random(-20,20)),velocity:_.fromAngle(i,R.random(10,50)),life:R.random(300,800),size:R.random(1,3),color:{r:255,g:255,b:255,a:1},fadeOut:!0,shrink:!0,gravity:!1};case y.CONFETTI:const t=[{r:255,g:0,b:0},{r:0,g:255,b:0},{r:0,g:0,b:255},{r:255,g:255,b:0},{r:255,g:0,b:255},{r:0,g:255,b:255}],s=R.randomChoice(t);return{position:e,velocity:_.fromAngle(i,R.random(100,300)),life:R.random(1e3,3e3),size:R.random(4,8),color:Object.assign(Object.assign({},s),{a:1}),fadeOut:!0,shrink:!1,gravity:!0};case y.HEARTS:return{position:e,velocity:_.fromAngle(i,R.random(20,80)),life:R.random(1500,2500),size:R.random(6,12),color:{r:255,g:R.random(100,200),b:R.random(100,200),a:1},fadeOut:!0,shrink:!1,gravity:!1};default:return{position:e,velocity:n,life:1e3,size:5,color:D.WHITE,fadeOut:!0}}}update(e){this.particles.forEach(t=>{t.update(e)}),this.particles=this.particles.filter(e=>e.isAlive)}render(e){this.particles.forEach(t=>{t.render(e)})}clear(){this.particles=[]}getParticleCount(){return this.particles.length}}class ie extends B{constructor(e,t="Button"){super(e,t),this.backgroundImage=null,this.particleSystem=null,this.isHovered=!1,this.scale=1,this.targetScale=1,this.glowIntensity=0,this.pulseTime=0,this.enableHoverEffect=!0,this.enableClickEffect=!0,this.enableGlow=!0,this.enablePulse=!1;const i=new M({name:"ButtonParticles"});this.particleSystem=new te(i,50),this.normalColor=new D(70,130,255,1),this.hoverColor=new D(100,150,255,1),this.pressedColor=new D(50,110,230,1),this.cornerRadius=12,this.borderWidth=2,this.borderColor=new D(255,255,255,.3)}update(e){super.update(e),this.particleSystem&&this.particleSystem.update(e),this.updateHoverEffect(e),this.updatePulseEffect(e),this.updateGlowEffect(e)}updateHoverEffect(e){}updatePulseEffect(e){if(!this.enablePulse)return;this.pulseTime+=e;const t=.05*Math.sin(.003*this.pulseTime)+1;this.targetScale=t}updateGlowEffect(e){if(!this.enableGlow)return;const t=e/1e3*5,i=this.isHovered?1:0;this.glowIntensity+=(i-this.glowIntensity)*t}setBackgroundImage(e){this.backgroundImage=e,this.setText("")}handleMouseMove(e){const t=this.isHovered;super.handleMouseMove(e);const i=this.getWorldBounds();this.isHovered=e.x>=i.x&&e.x<=i.x+i.width&&e.y>=i.y&&e.y<=i.y+i.height,this.isHovered&&!t?this.onHoverStart():!this.isHovered&&t&&this.onHoverEnd()}handleMouseDown(e){if(super.handleMouseDown(e),this.enableClickEffect&&this.isHovered&&this.particleSystem){const e=this.getWorldBounds(),t=new _(e.x+e.width/2,e.y+e.height/2);this.particleSystem.emitSparkles(t,8)}}onHoverStart(){if(this.targetScale=1.05,this.enableClickEffect&&this.particleSystem){const e=this.getWorldBounds(),t=new _(e.x+e.width/2,e.y+e.height/2);this.particleSystem.emitSparkles(t,3)}}onHoverEnd(){this.targetScale=1}onRender(e){const t=this.getWorldBounds();e.save(),this.enableGlow&&this.glowIntensity>0&&this.drawGlow(e,t),this.backgroundImage?e.drawImage(this.backgroundImage,t.x,t.y,t.width,t.height):super.onRender(e),this.particleSystem&&this.particleSystem.render(e),e.restore()}drawGlow(e,t){const i=20*this.glowIntensity,s=e.createRadialGradient(t.x+t.width/2,t.y+t.height/2,0,t.x+t.width/2,t.y+t.height/2,Math.max(t.width,t.height)/2+i);s.addColorStop(0,`rgba(100, 150, 255, ${.3*this.glowIntensity})`),s.addColorStop(1,"rgba(100, 150, 255, 0)"),e.fillStyle=s,e.fillRect(t.x-i,t.y-i,t.width+2*i,t.height+2*i)}}class se extends N{constructor(e,t=""){super(e,t),this.typewriterSpeed=50,this.fullText="",this.currentText="",this.typewriterTime=0,this.isTypewriting=!1,this.glowEffect=!1,this.shadowEffect=!0,this.rainbowEffect=!1,this.pulseEffect=!1,this.pulseTime=0,this.fullText=t,this.currentText="",this.shadowEffect=!0}startTypewriter(e=50){this.typewriterSpeed=e,this.isTypewriting=!0,this.typewriterTime=0,this.currentText=""}enableGlow(e=!0){this.glowEffect=e}enableRainbow(e=!0){this.rainbowEffect=e}enablePulse(e=!0){this.pulseEffect=e}setText(e){super.setText(e),this.fullText=e,this.isTypewriting||(this.currentText=e)}update(e){super.update(e),this.isTypewriting&&this.updateTypewriter(e),this.pulseEffect&&(this.pulseTime+=e)}updateTypewriter(e){this.typewriterTime+=e;const t=Math.floor(this.typewriterTime/1e3*this.typewriterSpeed);t>=this.fullText.length?(this.currentText=this.fullText,this.isTypewriting=!1):this.currentText=this.fullText.substring(0,t)}onRender(e){this.currentText||this.isTypewriting||(this.currentText=this.text);const t=this.getWorldBounds(),i=this.isTypewriting?this.currentText:this.text;if(!i)return;e.save(),e.font=this.font,e.textAlign=this.textAlign,e.textBaseline=this.textBaseline;const s=this.getTextX(t),n=this.getTextY(t);if(this.pulseEffect){const t=1+.1*Math.sin(.005*this.pulseTime);e.save(),e.translate(s,n),e.scale(t,t),e.translate(-s,-n)}this.glowEffect&&(e.shadowColor=new D(this.color.r,this.color.g,this.color.b,.8).toString(),e.shadowBlur=10),this.rainbowEffect?this.drawRainbowText(e,i,s,n):(this.shadowEffect&&(e.fillStyle="rgba(0, 0, 0, 0.5)",e.fillText(i,s+2,n+2)),e.fillStyle=new D(this.color.r,this.color.g,this.color.b,this.color.a).toString(),e.fillText(i,s,n)),this.pulseEffect&&e.restore(),e.restore()}drawRainbowText(e,t,i,s){const n=.005*Date.now();for(let a=0;a<t.length;a++){const o=(n+10*a)%360,r=D.fromHSL({h:o,s:70,l:60});e.fillStyle=r.toString();const h=e.measureText(t.substring(0,a)).width;e.fillText(t[a],i+h,s)}}getTextX(e){switch(this.textAlign){case"left":default:return e.x+this.padding.left;case"center":return e.x+e.width/2;case"right":return e.x+e.width-this.padding.right}}getTextY(e){switch(this.textBaseline){case"top":default:return e.y+this.padding.top;case"middle":return e.y+e.height/2;case"bottom":return e.y+e.height-this.padding.bottom}}}class ne extends G{constructor(e){super(e),this.gradientColors=[],this.animatedGradient=!1,this.gradientTime=0,this.glassEffect=!1,this.borderGlow=!1,this.floatingEffect=!1,this.floatTime=0,this.floatAmplitude=5,this.gradientColors=[new D(50,50,100,.9),new D(30,30,80,.9)],this.cornerRadius=15,this.borderWidth=2}setGradient(e){this.gradientColors=[...e]}enableAnimatedGradient(e=!0){this.animatedGradient=e}enableGlassEffect(e=!0){this.glassEffect=e}enableBorderGlow(e=!0){this.borderGlow=e}enableFloating(e=!0,t=5){this.floatingEffect=e,this.floatAmplitude=t}update(e){super.update(e),this.animatedGradient&&(this.gradientTime+=e),this.floatingEffect&&(this.floatTime+=e)}onRender(e){const t=this.getWorldBounds();if(this.floatingEffect){const e=Math.sin(.002*this.floatTime)*this.floatAmplitude;t.y+=e}e.save(),e.globalAlpha=this.alpha}createGradient(e,t){const i=e.createLinearGradient(t.x,t.y,t.x,t.y+t.height);if(this.animatedGradient&&this.gradientColors.length>=2){const e=.001*this.gradientTime,t=Math.floor(e)%this.gradientColors.length,s=(t+1)%this.gradientColors.length,n=e-Math.floor(e),a=this.gradientColors[t],o=this.gradientColors[s],r=new D(a.r+(o.r-a.r)*n,a.g+(o.g-a.g)*n,a.b+(o.b-a.b)*n,a.a+(o.a-a.a)*n);i.addColorStop(0,r.toString()),i.addColorStop(1,o.toString?o.toString():new D(o.r,o.g,o.b,o.a).toString())}else this.gradientColors.forEach((e,t)=>{const s=t/(this.gradientColors.length-1),n=e.toString?e.toString():new D(e.r,e.g,e.b,e.a).toString();i.addColorStop(s,n)});return i}drawGlassEffect(e,t){const i=e.createLinearGradient(t.x,t.y,t.x,t.y+.3*t.height);i.addColorStop(0,"rgba(255, 255, 255, 0.3)"),i.addColorStop(1,"rgba(255, 255, 255, 0)"),this.cornerRadius>0?(this.drawRoundedRect(e,t,this.cornerRadius),e.fillStyle=i,e.fill()):(e.fillStyle=i,e.fillRect(t.x,t.y,t.width,.3*t.height))}drawBorder(e,t){this.borderGlow&&(e.shadowColor=new D(this.borderColor.r,this.borderColor.g,this.borderColor.b,.8).toString(),e.shadowBlur=10),this.cornerRadius>0?this.drawRoundedRect(e,t,this.cornerRadius):e.rect(t.x,t.y,t.width,t.height),e.strokeStyle=new D(this.borderColor.r,this.borderColor.g,this.borderColor.b,this.borderColor.a).toString(),e.lineWidth=this.borderWidth,e.stroke()}drawRoundedRect(e,t,i){e.beginPath(),e.moveTo(t.x+i,t.y),e.lineTo(t.x+t.width-i,t.y),e.quadraticCurveTo(t.x+t.width,t.y,t.x+t.width,t.y+i),e.lineTo(t.x+t.width,t.y+t.height-i),e.quadraticCurveTo(t.x+t.width,t.y+t.height,t.x+t.width-i,t.y+t.height),e.lineTo(t.x+i,t.y+t.height),e.quadraticCurveTo(t.x,t.y+t.height,t.x,t.y+t.height-i),e.lineTo(t.x,t.y+i),e.quadraticCurveTo(t.x,t.y,t.x+i,t.y),e.closePath()}}class ae extends w{constructor(e,t=5){super(e),this.velocity=_.zero(),this.acceleration=_.zero(),this.mass=1,this.drag=.98,this.useGravity=!0,this.isKinematic=!1,this.isGrounded=!1,this.force=_.zero(),this.mass=t}addForce(e){this.isKinematic||(this.force=this.force.add(e))}setVelocity(e){this.velocity=new _(e.x,e.y)}getVelocity(){return new _(this.velocity.x,this.velocity.y)}update(e){if(!this.enabled||this.isKinematic)return;const t=.001*e;this.useGravity&&this.addForce(new _(ae.GRAVITY.x*this.mass,ae.GRAVITY.y*this.mass)),this.acceleration=new _(this.force.x/this.mass,this.force.y/this.mass),this.velocity=this.velocity.add(this.acceleration.multiply(t)),this.velocity=this.velocity.multiply(Math.pow(this.drag,t)),this.isGrounded&&this.velocity.y>0&&(this.velocity.y=0);const i=this.gameObject.getComponent(P);if(i){const e=this.velocity.multiply(t);this.isGrounded&&e.y>0&&(e.y=0),i.translate(e)}this.force=_.zero()}render(e){}serialize(){return Object.assign(Object.assign({},super.serialize()),{velocity:this.velocity,mass:this.mass,drag:this.drag,useGravity:this.useGravity,isKinematic:this.isKinematic})}deserialize(e){super.deserialize(e),_.isVector2(e.velocity)?this.velocity=new _(e.velocity.x,e.velocity.y):this.velocity=_.zero(),this.mass="number"==typeof e.mass?e.mass:1,this.drag="number"==typeof e.drag?e.drag:.98,this.useGravity=!1!==e.useGravity,this.isKinematic=!!e.isKinematic}}ae.GRAVITY=new _(0,900);class oe extends w{constructor(e){super(e),this.animations=new Map,this.activeAnimations=new Set}animate(e,t){const i=this.generateAnimationId(),s=new re(e,t);return this.animations.set(i,s),this.activeAnimations.add(i),i}stopAnimation(e){const t=this.animations.get(e);t&&(t.stop(),this.activeAnimations.delete(e))}stopAllAnimations(){this.activeAnimations.forEach(e=>{this.stopAnimation(e)})}update(e){const t=[];this.activeAnimations.forEach(i=>{const s=this.animations.get(i);s&&(s.update(e),s.isComplete()&&t.push(i))}),t.forEach(e=>{const t=this.animations.get(e);t&&t.config.onComplete&&t.config.onComplete(),t&&!t.config.loop?(this.animations.delete(e),this.activeAnimations.delete(e)):t&&t.config.loop&&t.restart()})}generateAnimationId(){return`anim_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}render(e){}}class re{constructor(e,t){this.startTime=0,this.currentTime=0,this.isRunning=!1,this.originalValues={position:new _(0,0),size:new _(0,0)},this.element=e,this.config=t,this.saveOriginalValues(),t.delay?setTimeout(()=>this.start(),t.delay):this.start()}saveOriginalValues(){this.originalValues={position:this.element.getGameObject().getPosition(),size:new _(this.element.size.x,this.element.size.y)}}start(){this.isRunning=!0,this.startTime=Date.now(),this.currentTime=0}stop(){this.isRunning=!1}restart(){this.currentTime=0,this.startTime=Date.now(),this.isRunning=!0}update(e){if(!this.isRunning)return;this.currentTime+=e;const t=Math.min(this.currentTime/this.config.duration,1),i=this.config.easing?this.config.easing(t):t;this.applyAnimation(i),t>=1&&(this.isRunning=!1)}applyAnimation(e){switch(this.config.type){case E.FadeIn:this.applyFadeIn(e);break;case E.FADE_OUT:this.applyFadeOut(e);break;case E.SLIDE_IN_FROM_TOP:this.applySlideFromTop(e);break;case E.SLIDE_IN_FROM_BOTTOM:this.applySlideFromBottom(e);break;case E.SLIDE_IN_FROM_LEFT:this.applySlideFromLeft(e);break;case E.SLIDE_IN_FROM_RIGHT:this.applySlideFromRight(e);break;case E.SCALE_IN:this.applyScaleIn(e);break;case E.SCALE_OUT:this.applyScaleOut(e);break;case E.BOUNCE:this.applyBounce(e);break;case E.PULSE:this.applyPulse(e);break;case E.SHAKE:this.applyShake(e)}}applyFadeIn(e){}applyFadeOut(e){}applySlideFromTop(e){const t=this.originalValues.position.y+-200*(1-e);this.element.getGameObject().setPosition(new _(this.originalValues.position.x,t))}applySlideFromBottom(e){const t=this.originalValues.position.y+200*(1-e);this.element.getGameObject().setPosition(new _(this.originalValues.position.x,t))}applySlideFromLeft(e){const t=this.originalValues.position.x+-200*(1-e);this.element.getGameObject().setPosition(new _(t,this.originalValues.position.y))}applySlideFromRight(e){const t=this.originalValues.position.x+200*(1-e);this.element.getGameObject().setPosition(new _(t,this.originalValues.position.y))}applyScaleIn(e){const t=e;this.element.size=new _(this.originalValues.size.x*t,this.originalValues.size.y*t)}applyScaleOut(e){const t=1-e;this.element.size=new _(this.originalValues.size.x*t,this.originalValues.size.y*t)}applyBounce(e){const t=20*Math.sin(e*Math.PI),i=this.originalValues.position.y-t;this.element.getGameObject().setPosition(new _(this.originalValues.position.x,i))}applyPulse(e){const t=1+.1*Math.sin(e*Math.PI*4);this.element.size=new _(this.originalValues.size.x*t,this.originalValues.size.y*t)}applyShake(e){const t=5*(1-e),i=(Math.random()-.5)*t,s=(Math.random()-.5)*t;this.element.getGameObject().setPosition(new _(this.originalValues.position.x+i,this.originalValues.position.y+s))}isComplete(){return!this.isRunning&&this.currentTime>=this.config.duration}}class he{static easeInQuad(e){return e*e}static easeOutQuad(e){return e*(2-e)}static easeInOutQuad(e){return e<.5?2*e*e:(4-2*e)*e-1}static easeInCubic(e){return e*e*e}static easeOutCubic(e){return--e*e*e+1}static easeInOutCubic(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1}static easeInBounce(e){return 1-he.easeOutBounce(1-e)}static easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}static easeInElastic(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-=1))*Math.sin((e-.075)*(2*Math.PI)/.3)}static easeOutElastic(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((e-.075)*(2*Math.PI)/.3)+1}}var le=function(e,t,i,s){return new(i||(i=Promise))(function(n,a){function o(e){try{h(s.next(e))}catch(e){a(e)}}function r(e){try{h(s.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,r)}h((s=s.apply(e,t||[])).next())})};class ce extends S{setEnabled(e){this.enabled=e}isEnabled(){return this.enabled}setVisible(e){this.visible=e}isVisible(){return this.visible}setMainCamera(e){this.mainCamera=e,this.dispatchEvent("main_camera_set",{camera:e})}constructor(e){super(),this.gameObjects=new Map,this.gameObjectsByTag=new Map,this.gameObjectsByLayer=new Map,this.state=r.NOT_LOADED,this.loadProgress=0,this.mainCamera=null,this.enabled=!0,this.visible=!0,this.name=e}getName(){return this.name}getState(){return this.state}getLoadProgress(){return this.loadProgress}addGameObject(e){this.gameObjects.set(e.id,e),this.gameObjectsByTag.has(e.tag)||this.gameObjectsByTag.set(e.tag,new Set),this.gameObjectsByTag.get(e.tag).add(e),this.gameObjectsByLayer.has(e.layer)||this.gameObjectsByLayer.set(e.layer,new Set),this.gameObjectsByLayer.get(e.layer).add(e),this.state===r.LOADED&&(e.awake(),e.start()),this.dispatchEvent("game_object_added",{gameObject:e})}removeGameObject(e){if(!this.gameObjects.has(e.id))return;this.gameObjects.delete(e.id);const t=this.gameObjectsByTag.get(e.tag);t&&(t.delete(e),0===t.size&&this.gameObjectsByTag.delete(e.tag));const i=this.gameObjectsByLayer.get(e.layer);i&&(i.delete(e),0===i.size&&this.gameObjectsByLayer.delete(e.layer)),this.dispatchEvent("game_object_removed",{gameObject:e})}findGameObject(e){return this.gameObjects.get(e)||null}findGameObjectByName(e){for(const t of this.gameObjects.values())if(t.name===e)return t;return null}findGameObjectByTag(e){const t=this.gameObjectsByTag.get(e);return t&&Array.from(t)[0]||null}findGameObjectsByTag(e){const t=this.gameObjectsByTag.get(e);return t?Array.from(t):[]}getAllGameObjects(){return Array.from(this.gameObjects.values())}getGameObjectCount(){return this.gameObjects.size}load(){return le(this,void 0,void 0,function*(){if(this.state===r.NOT_LOADED){this.state=r.LOADING,this.loadProgress=0;try{yield this.onLoad(),this.gameObjects.forEach(e=>{e.awake()}),this.gameObjects.forEach(e=>{e.start()}),this.state=r.LOADED,this.loadProgress=1,this.dispatchEvent("scene_loaded")}catch(e){throw this.state=r.NOT_LOADED,this.dispatchEvent("scene_load_error",{error:e}),e}}})}unload(){return le(this,void 0,void 0,function*(){if(this.state===r.LOADED){this.state=r.UNLOADING;try{this.gameObjects.forEach(e=>e.destroy()),this.gameObjects.clear(),this.gameObjectsByTag.clear(),this.gameObjectsByLayer.clear(),yield this.onUnload(),this.state=r.NOT_LOADED,this.loadProgress=0,this.dispatchEvent("scene_unloaded")}catch(e){throw this.dispatchEvent("scene_unload_error",{error:e}),e}}})}update(e){if(this.state!==r.LOADED)return;const t=[];this.gameObjects.forEach((e,i)=>{e.isDestroyed()&&t.push(i)}),t.forEach(e=>{const t=this.gameObjects.get(e);t&&this.removeGameObject(t)}),this.gameObjects.forEach(t=>{t.isActive()&&t.update(e)}),this.onUpdate(e)}render(e){if(this.state!==r.LOADED)return;e.save();const t=this.getMainCamera();if(t){const i=t.getGameObject().getComponent(P);if(i){const t=i.getWorldPosition();e.translate(0,-t.y+U/2)}}this.onRender(e),this.renderGameObjects(e),e.restore()}renderGameObjects(e){Array.from(this.gameObjects.values()).filter(e=>e.isActive()).sort((e,t)=>e.layer-t.layer).forEach(t=>{t.isVisible()&&t.render(e)})}getMainCamera(){return this.mainCamera}serialize(){const e={};return this.gameObjects.forEach((t,i)=>{e[i]=t.serialize()}),{name:this.name,gameObjects:e}}deserialize(e){"string"==typeof e.name&&(this.name=e.name),e.gameObjects&&Object.entries(e.gameObjects).forEach(([e,t])=>{const i=this.gameObjects.get(e);i&&t&&i.deserialize(t)})}}var de=function(e,t,i,s){return new(i||(i=Promise))(function(n,a){function o(e){try{h(s.next(e))}catch(e){a(e)}}function r(e){try{h(s.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,r)}h((s=s.apply(e,t||[])).next())})};class ue extends ce{constructor(e="GameOverScene"){super(e),this.finalScore=0,this.highScore=0,this.isNewHighScore=!1,this.animationComplete=!1,this.celebrationTime=0}onLoad(){return de(this,void 0,void 0,function*(){console.log("Loading Enhanced Game Over Scene..."),this.gameEngine=j.getInstance(),this.loadScores(),yield this.createEffectSystems(),yield this.createPlayerDead(),yield this.createUI(),yield this.playEntranceAnimation(),console.log("Enhanced Game Over Scene loaded!")})}onUnload(){return de(this,void 0,void 0,function*(){console.log("Unloading Enhanced Game Over Scene...");const e=this.gameEngine.getUIManager();e&&this.backgroundPanel&&e.removeRootElement(this.backgroundPanel)})}loadScores(){try{const e=localStorage.getItem(L.HIGH_SCORE_KEY),t=localStorage.getItem(L.CURRENT_SCORE_KEY);this.finalScore=t?parseInt(t,10):0,this.highScore=e?parseInt(e,10):0,this.isNewHighScore=this.finalScore>=this.highScore,this.isNewHighScore&&(this.highScore=this.finalScore,localStorage.setItem(L.HIGH_SCORE_KEY,this.highScore.toString()))}catch(e){console.warn("Error loading scores:",e),this.finalScore=0,this.highScore=0}}createEffectSystems(){return de(this,void 0,void 0,function*(){const e=new M({name:"GameOverAnimator"});this.animator=new oe(e),e.addComponent(this.animator),this.addGameObject(e);const t=new M({name:"GameOverParticles"});this.particleSystem=new te(t,300),t.addComponent(this.particleSystem),this.addGameObject(t)})}createUI(){return de(this,void 0,void 0,function*(){yield this.createBackgroundPanel(),yield this.createGameOverTitle(),yield this.createScorePanel(),yield this.createButtons(),this.addUIToManager()})}createPlayerDead(){return de(this,void 0,void 0,function*(){const e=new M({name:"PlayerDead",position:new _(H/2,-U/2)}),t=new ae(e,1);t.useGravity=!0;const i=new Z(e);i.addAnimation(L.ANIMATIONS.PLAYER_DEAD.name,L.ANIMATIONS.PLAYER_DEAD.frames,this.gameEngine,L.ANIMATIONS.PLAYER_DEAD.frameRate,L.ANIMATIONS.PLAYER_DEAD.loop),i.playAnimation(L.ANIMATIONS.PLAYER_DEAD.name),e.addComponent(t),e.addComponent(i),this.addGameObject(e)})}createBackgroundPanel(){return de(this,void 0,void 0,function*(){const e=new M({name:"GameOverPanel",position:new _(0,0)});this.backgroundPanel=new ne(e),this.backgroundPanel.setAnchor(d.MIDDLE_CENTER),this.backgroundPanel.size=new _(H,U),this.backgroundPanel.setGradient([new D(40,20,20,.95),new D(20,20,40,.95),new D(40,20,60,.95)]),this.backgroundPanel.enableAnimatedGradient(!0),this.backgroundPanel.enableGlassEffect(!0),this.backgroundPanel.enableBorderGlow(!0),this.backgroundPanel.cornerRadius=25,this.backgroundPanel.borderColor=new D(255,100,100,.8),this.backgroundPanel.borderWidth=3;const t=new M({name:"BackgroundRenderer",position:new _(H/2,U/2),layer:-100}),i=new Q(t),s=j.getInstance().getResourceManager().getResource(L.IMAGES.BACKGROUND.GAMEPLAY_BACKGROUND);i.setImage(s),i.setImageSize(H,U),t.addComponent(i),e.addComponent(this.backgroundPanel),this.addGameObject(t),this.addGameObject(e)})}createGameOverTitle(){return de(this,void 0,void 0,function*(){const e=new M({name:"GameOverTitle",position:new _(H/2-250,100)});this.gameOverLabel=new se(e,"GAME OVER"),this.gameOverLabel.setAnchor(d.MIDDLE_CENTER),this.gameOverLabel.setFont('42px "Arial Black", Arial'),this.gameOverLabel.setColor(new D(255,100,100,1)),this.gameOverLabel.setTextAlign("center"),this.gameOverLabel.setTextBaseline("middle"),this.gameOverLabel.size=new _(500,60),this.gameOverLabel.enableGlow(!0),this.gameOverLabel.enablePulse(!0),e.addComponent(this.gameOverLabel),e.setActive(!1),this.backgroundPanel.addChild(this.gameOverLabel)})}createScorePanel(){return de(this,void 0,void 0,function*(){const e=new M({name:"ScorePanel",position:new _(H/2-200,300)});this.scorePanel=new ne(e),e.addComponent(this.scorePanel),this.backgroundPanel.addChild(this.scorePanel);const t=new M({name:"FinalScoreLabel",position:new _(0,-60)});this.finalScoreLabel=new se(t,`Your Score: ${this.finalScore}`),this.finalScoreLabel.setAnchor(d.MIDDLE_CENTER),this.finalScoreLabel.setFont('28px "Arial Black", Arial'),this.finalScoreLabel.setColor(new D(255,255,100,1)),this.finalScoreLabel.setTextAlign("center"),this.finalScoreLabel.size=new _(400,40),this.finalScoreLabel.enableGlow(!0),t.addComponent(this.finalScoreLabel),this.scorePanel.addChild(this.finalScoreLabel),t.setActive(!1);const i=new M({name:"HighScoreLabel",position:new _(0,-10)}),s=this.isNewHighScore?`NEW HIGH SCORE: ${this.highScore}`:`High Score: ${this.highScore}`;this.highScoreLabel=new se(i,s),this.highScoreLabel.setAnchor(d.MIDDLE_CENTER),this.highScoreLabel.setFont("20px Arial"),this.highScoreLabel.setColor(this.isNewHighScore?new D(255,215,0,1):new D(200,200,255,1)),this.highScoreLabel.setTextAlign("center"),this.highScoreLabel.size=new _(400,30),this.highScoreLabel.getGameObject().setActive(!1),i.addComponent(this.highScoreLabel),this.scorePanel.addChild(this.highScoreLabel);const n=new M({name:"PerformanceLabel",position:new _(0,40)}),a=this.getPerformanceMessage();this.performanceLabel=new se(n,a),this.performanceLabel.setAnchor(d.MIDDLE_CENTER),this.performanceLabel.setFont("16px Arial"),this.performanceLabel.setColor(new D(180,180,255,.8)),this.performanceLabel.setTextAlign("center"),this.performanceLabel.size=new _(400,25),n.setActive(!1),n.addComponent(this.performanceLabel),this.scorePanel.addChild(this.performanceLabel),e.setActive(!1)})}createButtons(){return de(this,void 0,void 0,function*(){const e=new M({name:"RestartButton",position:new _(H/2-250,U/2+75)});this.restartButton=new ie(e,"PLAY AGAIN"),this.restartButton.setAnchor(d.MIDDLE_CENTER),this.restartButton.size=new _(200,60),this.restartButton.setColors(new D(50,200,50,1),new D(255,255,255,1),new D(80,230,80,1)),this.restartButton.enableHoverEffect=!0,this.restartButton.enableClickEffect=!0,this.restartButton.enableGlow=!0,this.restartButton.setOnClick(()=>this.onRestartClick()),e.addComponent(this.restartButton),this.backgroundPanel.addChild(this.restartButton),e.setActive(!1);const t=new M({name:"MenuButton",position:new _(H/2+50,U/2+75)});this.menuButton=new ie(t,"MENU"),this.menuButton.setAnchor(d.MIDDLE_CENTER),this.menuButton.size=new _(200,60),this.menuButton.setColors(new D(100,100,200,1),new D(255,255,255,1),new D(130,130,230,1)),this.menuButton.enableHoverEffect=!0,this.menuButton.enableClickEffect=!0,this.menuButton.setOnClick(()=>this.onMenuClick()),t.addComponent(this.menuButton),this.backgroundPanel.addChild(this.menuButton),t.setActive(!1)})}addUIToManager(){const e=this.gameEngine.getUIManager();e&&this.backgroundPanel&&e.addRootElement(this.backgroundPanel)}playEntranceAnimation(){return de(this,void 0,void 0,function*(){this.animator.animate(this.backgroundPanel,{type:E.FadeIn,duration:800,easing:he.easeOutCubic}),setTimeout(()=>{this.gameOverLabel.getGameObject().setActive(!0),this.animator.animate(this.gameOverLabel,{type:E.SLIDE_IN_FROM_TOP,duration:600,easing:he.easeOutBounce})},300),setTimeout(()=>{this.scorePanel.getGameObject().setActive(!0),this.animator.animate(this.scorePanel,{type:E.SCALE_IN,duration:500,easing:he.easeOutElastic})},800),setTimeout(()=>{this.finalScoreLabel.getGameObject().setActive(!0),this.finalScoreLabel.startTypewriter(40)},1200),setTimeout(()=>{this.highScoreLabel.getGameObject().setActive(!0),this.highScoreLabel.startTypewriter(50)},1800),setTimeout(()=>{this.performanceLabel.getGameObject().setActive(!0),this.performanceLabel.startTypewriter(50)},2400),setTimeout(()=>{this.restartButton.getGameObject().setActive(!0),this.animator.animate(this.restartButton,{type:E.SLIDE_IN_FROM_BOTTOM,duration:400,easing:he.easeOutQuad})},2800),setTimeout(()=>{this.menuButton.getGameObject().setActive(!0),this.animator.animate(this.menuButton,{type:E.SLIDE_IN_FROM_BOTTOM,duration:300,easing:he.easeOutQuad})},3e3),this.isNewHighScore&&this.startCelebration()})}startCelebration(){if(!this.isNewHighScore)return;const e=new _(H/2,U/2);this.particleSystem.emitConfetti(e,50);for(let e=0;e<8;e++)setTimeout(()=>{const e=Math.random()*H,t=Math.random()*U;this.particleSystem.emitHearts(new _(e,t),3)},200*e)}getPerformanceMessage(){return 0===this.finalScore?"Try again!":this.finalScore<100?"Keep practicing!":this.finalScore<500?"Not bad!":this.finalScore<1e3?"Good job!":this.finalScore<2e3?"Excellent!":"AMAZING!"}onRestartClick(){if(console.log("Restarting game..."),this.particleSystem){const e=this.restartButton.getWorldBounds(),t=new _(e.x+e.width/2,e.y+e.height/2);this.particleSystem.emitSparkles(t,10)}setTimeout(()=>{this.gameEngine.setScene("GameplayScene")},200)}onMenuClick(){console.log("Going to menu..."),setTimeout(()=>{this.gameEngine.setScene("MainMenuScene")},200)}setScores(e,t){if(this.finalScore=e,this.highScore=t,this.isNewHighScore=e>t,this.finalScoreLabel&&this.finalScoreLabel.setText(`Your Score: ${this.finalScore}`),this.highScoreLabel){const e=this.isNewHighScore?`NEW HIGH SCORE: ${this.highScore}`:`High Score: ${this.highScore}`;this.highScoreLabel.setText(e)}}onUpdate(e){if(this.celebrationTime+=e,this.isNewHighScore&&this.animationComplete&&Math.random()<.02){const e=Math.random()*H,t=Math.random()*U;this.particleSystem.emitStars(new _(e,t),2)}}onRender(e){e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(0,0,H,U),this.particleSystem&&this.particleSystem.render(e),this.isNewHighScore&&this.animationComplete&&this.drawCelebrationEffects(e),this.drawMobileInstructions(e)}drawCelebrationEffects(e){const t=.005*this.celebrationTime;e.save(),e.strokeStyle=`hsla(${60*t%360}, 70%, 60%, 0.5)`,e.lineWidth=5+3*Math.sin(2*t),e.strokeRect(10,10,H-20,U-20),e.restore()}drawMobileInstructions(e){"ontouchstart"in window&&this.animationComplete&&(e.save(),e.fillStyle="rgba(255, 255, 255, 0.8)",e.font="16px Arial",e.textAlign="center",e.fillText("Tap to play again",H/2,U-20),e.restore())}}class ge extends w{constructor(e){super(e),this.type=l.ORTHOGRAPHIC,this.size=5,this.fieldOfView=60,this.target=null,this.followSmoothing=5,this.shakeIntensity=0,this.shakeDuration=0,this.shakeOffset=_.zero()}setTarget(e){this.target=e}shake(e,t){this.shakeIntensity=e,this.shakeDuration=t}worldToScreen(e,t){const i=this.gameObject.getComponent(P).getWorldPosition().add(this.shakeOffset);return new _(e.x-i.x+t.x/2,e.y-i.y+t.y/2)}screenToWorld(e,t){const i=this.gameObject.getComponent(P).getWorldPosition().add(this.shakeOffset);return new _(e.x-t.x/2+i.x,e.y-t.y/2+i.y)}isInView(e,t){const i=this.getViewBounds(t);return this.boundsOverlap(i,e)}getViewBounds(e){const t=this.gameObject.getComponent(P).getWorldPosition().add(this.shakeOffset),i=e.x/2,s=e.y/2;return{x:t.x-i,y:t.y-s,width:e.x,height:e.y}}boundsOverlap(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}update(e){if(this.enabled){if(this.target){const t=this.target.getPosition(),i=this.gameObject.getComponent(P),s=i.getWorldPosition();if(this.followSmoothing>0){const n=_.lerp(s,t,this.followSmoothing*e/1e3);i.setPosition(n)}else i.setPosition(new _(t.x,t.y))}if(this.shakeDuration>0)if(this.shakeDuration-=e,this.shakeDuration>0){const e=Math.random()*Math.PI*2,t=this.shakeIntensity*(this.shakeDuration/1e3);this.shakeOffset=_.fromAngle(e,t)}else this.shakeOffset=_.zero()}}render(e){}serialize(){return Object.assign(Object.assign({},super.serialize()),{type:this.type,size:this.size,fieldOfView:this.fieldOfView,followSmoothing:this.followSmoothing})}deserialize(e){super.deserialize(e),this.type="string"==typeof e.type?e.type:l.ORTHOGRAPHIC,this.size="number"==typeof e.size?e.size:5,this.fieldOfView="number"==typeof e.fieldOfView?e.fieldOfView:60,this.followSmoothing="number"==typeof e.followSmoothing?e.followSmoothing:5}}class me extends w{constructor(e,t=s.BOX){super(e),this.type=s.BOX,this.width=50,this.height=50,this.radius=25,this.offset=_.zero(),this.isTrigger=!1,this.layers=[n.DEFAULT],this.mask=[n.ALL],this.type=t}static createBox(e,t,i,n){const a=new me(e,s.BOX);return a.width=t,a.height=i,n&&(a.offset=n),a}static createCircle(e,t,i){const n=new me(e,s.CIRCLE);return n.radius=t,i&&(n.offset=i),n}getBounds(){const e=this.gameObject.getComponent(P);if(!e)return{x:0,y:0,width:0,height:0};const t=e.getWorldPosition(),i=new _(t.x+this.offset.x,t.y+this.offset.y);switch(this.type){case s.BOX:return{x:i.x-this.width/2,y:i.y-this.height/2,width:this.width,height:this.height};case s.CIRCLE:return{x:i.x-this.radius,y:i.y-this.radius,width:2*this.radius,height:2*this.radius};case s.POLYGON:return{x:i.x-this.width/2,y:i.y-this.height/2-this.height/20,width:this.width,height:this.height/20};default:return{x:i.x,y:i.y-this.renderer.getHeight()/2,width:this.width,height:this.height}}}setColliderSize(e,t){this.width=e,this.height=t}setRenderer(e){this.renderer=e,e&&(this.width=e.getWidth(),this.height=e.getHeight(),this.radius=Math.max(this.width,this.height)/2)}setColliderType(e){this.type=e,e===s.CIRCLE?this.radius=Math.max(this.width,this.height)/2:this.radius=0}onCollision(e,t){this.isTrigger?this.dispatchEvent(g,{other:e,collisionInfo:t}):this.dispatchEvent(m,{other:e,collisionInfo:t})}onCollisionExit(e){this.isTrigger?this.dispatchEvent("trigger_exit",{other:e}):this.dispatchEvent(p,{other:e})}getCollisionLayers(){return this.layers}getCollisionMask(){return this.mask}setCollisionLayers(e){this.layers=e}setCollisionMask(e){this.mask=e}canCollideWith(e){const t=this.mask.some(t=>e.layers.includes(t)),i=e.mask.some(e=>this.layers.includes(e));return t&&i}update(e){}render(e){}serialize(){return Object.assign(Object.assign({},super.serialize()),{type:this.type,width:this.width,height:this.height,radius:this.radius,offset:this.offset,isTrigger:this.isTrigger,layers:this.layers,mask:this.mask})}deserialize(e){super.deserialize(e),this.type="string"==typeof e.type?e.type:s.BOX,this.width="number"==typeof e.width?e.width:50,this.height="number"==typeof e.height?e.height:50,this.radius="number"==typeof e.radius?e.radius:25,_.isVector2(e.offset)?this.offset=new _(e.offset.x,e.offset.y):this.offset=_.zero(),this.isTrigger="boolean"==typeof e.isTrigger&&e.isTrigger,this.layers=Array.isArray(e.layers)?e.layers:[n.DEFAULT],this.mask=Array.isArray(e.mask)?e.mask:[n.ALL]}}const pe="player_jump",Ee="player_hit_obstacle";var ye;!function(e){e.IDLE="idle",e.MOVING_LEFT="moving_left",e.MOVING_RIGHT="moving_right",e.ON_PLATFORM="on_platform",e.IN_AIR="in_air"}(ye||(ye={}));class fe extends w{constructor(e){super(e),this.isGrounded=!1,this.canJump=!0,this.isUsingJetpack=!1,this.jetpack=L.ITEMS.JETPACK,this.currentFuel=0,this.isDead=!1,this.inputLeft=!1,this.inputRight=!1,this.inputJump=!1}onAwake(){this.transform=this.gameObject.getComponent(P),this.rigidBody=this.gameObject.getComponent(ae),this.collider=this.gameObject.getComponent(me),this.animatedRenderer=this.gameObject.getComponent(Z),console.log("Player components check:",{transform:!!this.transform,rigidBody:!!this.rigidBody,collider:!!this.collider,animatedRenderer:!!this.animatedRenderer}),this.transform&&this.rigidBody&&this.collider&&this.animatedRenderer?(this.animatedRenderer.setVisible(!0),this.collider.setColliderSize(this.animatedRenderer.getWidth()-48,this.animatedRenderer.getHeight()),this.collider.setColliderType(s.BOX),this.collider.layers=[n.PLAYER],this.collider.mask=[n.GROUND,n.ENVIRONMENT],this.collider.addEventListener(m,this.onCollisionEnter.bind(this)),this.collider.addEventListener(p,this.onCollisionExit.bind(this)),this.addEventListener(Ee,this.onPlayerHitObstacle.bind(this)),j.getInstance().getCollisionManager().addCollider(this.collider),this.gameObject.tag="Player"):console.error("Player missing components!")}setInput(e,t,i){i||(this.inputLeft=e,this.inputRight=t),this.inputJump=i}update(e){this.transform&&this.rigidBody&&(this.handleInput(),this.updateMovement(),this.checkBounds(),this.updateVisuals(),this.handleJetpack(e),this.updateAudio())}setUsingJetpack(e){this.isUsingJetpack=e,this.currentFuel=e?this.jetpack.FUEL:0}handleJetpack(e){if(!this.isUsingJetpack)return;if(this.isDead||this.currentFuel<=0)return void this.setUsingJetpack(!1);const t=.001*e;this.currentFuel-=this.jetpack.FUEL_CONSUMPTION_RATE*t,this.currentFuel<=0&&this.setUsingJetpack(!1)}handleInput(){if(this.isDead)return;const e=this.rigidBody.getVelocity();this.inputLeft?this.rigidBody.setVelocity(new _(-L.PLAYER.MOVE_SPEED,e.y)):this.inputRight?this.rigidBody.setVelocity(new _(L.PLAYER.MOVE_SPEED,e.y)):this.rigidBody.setVelocity(new _(.8*e.x,e.y)),this.inputJump&&this.isUsingJetpack&&this.jump()}jump(){this.isUsingJetpack||j.getInstance().getAudioManager().playSound(L.AUDIO.SFX.JUMP),this.rigidBody.setVelocity(new _(this.rigidBody.getVelocity().x,L.PLAYER.JUMP_FORCE)),this.isGrounded=!1,this.canJump=!1,this.dispatchEvent(pe)}updateMovement(){const e=this.rigidBody.getVelocity();e.y>L.PLAYER.MAX_FALL_SPEED&&this.rigidBody.setVelocity(new _(e.x,L.PLAYER.MAX_FALL_SPEED))}checkBounds(){const e=this.transform.getWorldPosition();e.x<-L.PLAYER.WIDTH/2?this.transform.setPosition(new _(H+L.PLAYER.WIDTH/2,e.y)):e.x>H+L.PLAYER.WIDTH/2&&this.transform.setPosition(new _(-L.PLAYER.WIDTH/2,e.y))}updateVisuals(){if(!this.animatedRenderer)return;if(this.isDead)return;const e=this.rigidBody.getVelocity();this.isUsingJetpack?e.x>1?this.animatedRenderer.playAnimation(L.ANIMATIONS.PLAYER_MOVE_RIGHT_JETPACK.name):e.x<-1?this.animatedRenderer.playAnimation(L.ANIMATIONS.PLAYER_MOVE_LEFT_JETPACK.name):this.animatedRenderer.playAnimation(L.ANIMATIONS.PLAYER_IDLE_JETPACK.name):e.x>1?this.animatedRenderer.playAnimation(L.ANIMATIONS.PLAYER_MOVE_RIGHT.name):e.x<-1?this.animatedRenderer.playAnimation(L.ANIMATIONS.PLAYER_MOVE_LEFT.name):this.animatedRenderer.playAnimation(L.ANIMATIONS.PLAYER_IDLE.name)}updateAudio(){if(this.isDead)return;const e=this.rigidBody.getVelocity();this.isGrounded&&(e.x>1||e.x<-1)&&j.getInstance().getAudioManager().playSound(L.AUDIO.SFX.WALK)}onCollisionEnter(e){const{other:t,collisionInfo:i}=e.data;if(!t.isTrigger&&this.rigidBody.velocity.y>0&&this.transform.getWorldPosition().y+.75*this.collider.height<t.getGameObject().getComponent(P).getWorldPosition().y){this.rigidBody.isGrounded||(this.rigidBody.isGrounded=!0);const e=this.gameObject.getComponent(P),i=t.getGameObject().getComponent(P);this.transform.setPosition(new _(e.getWorldPosition().x,i.getWorldPosition().y-t.height/2-this.collider.height/2+8)),this.isGrounded=!0,this.canJump=!0,this.rigidBody.setVelocity(new _(this.rigidBody.getVelocity().x,0)),this.jump()}}onCollisionExit(e){const{other:t}=e.data;this.isGrounded=!1,this.canJump=!1,this.rigidBody.isGrounded=!1}onPlayerHitObstacle(e){this.isDead||(this.isDead=!0,this.gameObject.removeComponent(me),j.getInstance().getCollisionManager().removeCollider(this.collider),this.rigidBody.setVelocity(new _(0,L.PLAYER.JUMP_FORCE)),this.animatedRenderer.playAnimation(L.ANIMATIONS.PLAYER_DEAD.name),this.getGameObject().destroy)}getScore(){if(!this.transform)return 0;const e=U-150,t=this.transform.getWorldPosition().y;return Math.max(0,Math.floor((e-t)/10))}setPlayerDead(e){this.isDead=e}isPlayerDead(){return this.isDead}render(e){}}class Ae extends ge{constructor(e){super(e),this.offset=new _(0,F),this.smoothing=5,this.highestY=0,this.playerDeadTimer=0,this.hasPlayerDied=!1,this.DEAD_FOLLOW_DURATION=1}setTarget(e){if(this.target=e,e){this.highestY=e.getPosition().y;const t=e.getComponent(fe);t?this.player=t:console.warn("CameraFollow: Target does not have a Player component.")}}setOffset(e){this.offset=e.clone()}setSmoothing(e){this.smoothing=e}update(e){if(super.update(e),!this.target)return;const t=this.gameObject.getComponent(P),i=this.target.getPosition(),s=t.getWorldPosition();i.y<this.highestY&&(this.highestY=i.y);const n=this.highestY+this.offset.y,a=new _(H/2,n);if(this.player&&(this.player.isPlayerDead()?this.hasPlayerDied?this.playerDeadTimer+=e/1e3:(this.hasPlayerDied=!0,this.playerDeadTimer=0):(this.hasPlayerDied=!1,this.playerDeadTimer=0)),this.player&&!this.player.isPlayerDead())t.setPosition(a);else if(this.hasPlayerDied&&this.playerDeadTimer<=this.DEAD_FOLLOW_DURATION){const n=e/1e3,a=_.lerp(s,i,this.smoothing*n);t.setPosition(a)}}getCameraViewBounds(){const e=this.gameObject.getComponent(P).getWorldPosition();return{top:e.y-U/2,bottom:e.y+U/2,left:e.x-H/2,right:e.x+H/2}}isInView(e,t){const i=this.getCameraViewBounds();return e.x+e.width>i.left&&e.x<i.right&&e.y+e.height>i.top&&e.y<i.bottom}}class Se extends w{constructor(e,t=L.BACKGROUND.CLOUD.MOVE_SPEED){super(e),this.speed=t,this.direction=R.randomSign()}update(e){const t=this.gameObject.getComponent(P);if(!t)return;const i=t.getWorldPosition(),s=i.x+this.direction*this.speed*(e/1e3);s<-L.BACKGROUND.CLOUD.WIDTH?t.setPosition(new _(H+L.BACKGROUND.CLOUD.WIDTH,i.y)):s>H+L.BACKGROUND.CLOUD.WIDTH?t.setPosition(new _(-L.BACKGROUND.CLOUD.WIDTH,i.y)):t.setPosition(new _(s,i.y))}render(e){}}class be extends w{constructor(e,t){super(e),this.clouds=[],this.camera=null,this.scene=t}setCamera(e){this.camera=e}onStart(){this.bgImage=j.getInstance().getResourceManager().getResource(L.IMAGES.BACKGROUND.GAMEPLAY_BACKGROUND),this.cloudImage=j.getInstance().getResourceManager().getResource(L.IMAGES.CLOUD),this.generateClouds()}update(e){this.updateClouds(),this.manageClouds()}generateClouds(){for(let e=0;e<L.BACKGROUND.CLOUD.COUNT;e++)this.createCloud(new _(R.random(0,H),R.random(-500,U)))}createCloud(e){const t=new M({name:"Cloud",tag:"Background",layer:1,position:e}),i=new Q(t);i.setColor(new D(255,255,255,.7)),i.setImage(this.cloudImage),i.setImageSize(L.BACKGROUND.CLOUD.WIDTH,L.BACKGROUND.CLOUD.HEIGHT),t.addComponent(i);const s=new Se(t);return t.addComponent(s),this.scene.addGameObject(t),this.clouds.push(t),t}updateClouds(){}manageClouds(){if(!this.camera)return;const e=this.camera.getGameObject().getComponent(P);if(!e)return;const t=e.getWorldPosition().y,i=t-U/2-200,s=t+U/2+200;for(this.clouds=this.clouds.filter(e=>!(e.getPosition().y>s+300&&(this.scene.removeGameObject(e),e.destroy(),1)));this.clouds.length<L.BACKGROUND.CLOUD.COUNT;)this.createCloud(new _(R.random(0,H),i-R.random(50,200)))}render(e){this.renderImageBackground(e)}renderImageBackground(e){if(!this.camera)return;const t=this.camera.getGameObject().getComponent(P);if(!t)return;if(!this.bgImage)return;const i=t.getWorldPosition().y;e.drawImage(this.bgImage,0,i-U/2,H,U)}}class Te extends w{constructor(e,t){super(e),this.player=null,this.leftPressed=!1,this.rightPressed=!1,this.jumpPressed=!1,this.isTouching=!1,this.inputManager=t,this.setupTouchEvents()}setPlayer(e){this.player=e}update(e){this.handleKeyboardInput(),this.handleMouseInput(),this.handleTouchInput(),this.sendInputToPlayer()}handleKeyboardInput(){this.leftPressed=this.inputManager.isKeyPressed(W)||this.inputManager.isKeyPressed(K),this.rightPressed=this.inputManager.isKeyPressed(z)||this.inputManager.isKeyPressed(J),this.jumpPressed=this.inputManager.isKeyPressed(Y)||this.inputManager.isKeyPressed(V)||this.inputManager.isKeyPressed(X)}handleMouseInput(){if(this.inputManager.isMouseButtonPressed(t.LEFT)){const e=this.inputManager.getMousePosition(),t=H;e.x<t/3?this.leftPressed=!0:e.x>2*t/3&&(this.rightPressed=!0),this.jumpPressed=!0}}handleTouchInput(){const e=this.inputManager.getTouches();if(e.length>0){const t=e[0],i=H;this.isTouching?t.position.x<i/3?this.leftPressed=!0:t.position.x>2*i/3&&(this.rightPressed=!0):(this.isTouching=!0,this.jumpPressed=!0)}else this.isTouching=!1}setupTouchEvents(){const e=document.getElementById("game-canvas");e&&(e.addEventListener("touchstart",e=>e.preventDefault()),e.addEventListener("touchmove",e=>e.preventDefault()),e.addEventListener("touchend",e=>e.preventDefault()))}sendInputToPlayer(){this.player&&this.player.setInput(this.leftPressed,this.rightPressed,this.jumpPressed),this.resetInputStates()}resetInputStates(){this.inputManager.isKeyPressed(Y)||this.inputManager.isKeyPressed(V)||this.inputManager.isKeyPressed(X)||this.inputManager.isMouseButtonPressed(t.LEFT)||0!==this.inputManager.getTouchCount()||(this.jumpPressed=!1),this.inputManager.isKeyPressed(W)||this.inputManager.isKeyPressed(K)||this.inputManager.isMouseButtonPressed(t.LEFT)||0!==this.inputManager.getTouchCount()||(this.leftPressed=!1),this.inputManager.isKeyPressed(z)||this.inputManager.isKeyPressed(J)||this.inputManager.isMouseButtonPressed(t.LEFT)||0!==this.inputManager.getTouchCount()||(this.rightPressed=!1)}render(e){this.drawMobileInputGuide(e)}drawMobileInputGuide(e){"ontouchstart"in window&&(e.save(),e.globalAlpha=.3,e.fillStyle="white",e.font="16px Arial",e.textAlign="center",e.fillText("",166,750),e.fillText("",833,750),e.fillText("TAP TO JUMP",500,750),e.restore())}}class _e extends w{constructor(e){super(e),this.currentScore=0,this.lastDifficultyScore=0,this.highScore=0,this.baselineY=0,this.scoreLabel=null,this.highScoreLabel=null,this.player=null,this.loadHighScore()}onStart(){this.createScoreUI(),this.currentScore=0,this.lastDifficultyScore=1,localStorage.removeItem(L.CURRENT_SCORE_KEY)}setPlayer(e){this.player=e,this.baselineY=e.getPosition().y}update(e){this.updateScore(),this.updateUI(),this.updateDifficultyLevel()}static getCurrentDifficultyLevel(){return this.difficultyLevel}updateDifficultyLevel(){this.currentScore-this.lastDifficultyScore>=L.DIFFICULTY&&(_e.difficultyLevel++,R.clamp(_e.difficultyLevel,1,6),this.lastDifficultyScore=this.currentScore)}createScoreUI(){const e=new M({name:"ScoreLabel",position:new _(100,-300),tag:"UI",layer:1e3});this.scoreLabel=new N(e,"Score: 0"),this.scoreLabel.setCanvas(j.getInstance().getCanvas()),this.scoreLabel.setFont("24px Arial"),this.scoreLabel.setColor(D.WHITE),this.scoreLabel.setAnchor(d.TOP_LEFT),this.scoreLabel.size=new _(200,40),this.scoreLabel.margin={top:20,left:20,bottom:0,right:0},e.addComponent(this.scoreLabel);const t=new M({name:"HighScoreLabel",position:new _(0,0),tag:"UI",layer:1e3});this.highScoreLabel=new N(t,`High: ${this.highScore}`),this.highScoreLabel.setCanvas(j.getInstance().getCanvas()),this.highScoreLabel.setFont("24px Arial"),this.highScoreLabel.setColor(D.YELLOW),this.highScoreLabel.setAnchor(d.TOP_LEFT),this.highScoreLabel.size=new _(200,40),this.highScoreLabel.margin={top:20,right:20,bottom:0,left:0},t.addComponent(this.highScoreLabel)}updateScore(){if(!this.player)return;const e=this.player.getPosition().y,t=Math.max(0,Math.floor((this.baselineY-e)/10));t>this.currentScore&&(this.currentScore=t,this.currentScore>this.highScore&&(this.highScore=this.currentScore,this.saveHighScore()))}updateUI(){var e;const t=null===(e=j.getInstance().getCurrentScene())||void 0===e?void 0:e.getMainCamera();if(!t)return;const i=t.getGameObject().getPosition();if(this.scoreLabel){this.scoreLabel.setText(`Score: ${this.currentScore}`);const e=new _(0,i.y-350);this.scoreLabel.setLocalPosition(e)}if(this.highScoreLabel){this.highScoreLabel.setText(`High: ${this.highScore}`);const e=new _(0,i.y-300);this.highScoreLabel.setLocalPosition(e)}}getCurrentScore(){return this.currentScore}getHighScore(){return this.highScore}resetScore(){this.currentScore=0,this.player&&(this.baselineY=this.player.getPosition().y)}addBonusScore(e){this.currentScore+=e,this.currentScore>this.highScore&&(this.highScore=this.currentScore,this.saveHighScore())}loadHighScore(){try{const e=localStorage.getItem(L.HIGH_SCORE_KEY);this.highScore=e?parseInt(e,10):0}catch(e){console.warn("Could not load high score:",e),this.highScore=0}}saveHighScore(){try{localStorage.setItem(L.HIGH_SCORE_KEY,this.highScore.toString()),localStorage.setItem(L.CURRENT_SCORE_KEY,this.currentScore.toString())}catch(e){console.warn("Could not save high score:",e)}}render(e){var t,i;null===(t=this.scoreLabel)||void 0===t||t.render(e),null===(i=this.highScoreLabel)||void 0===i||i.render(e)}}_e.difficultyLevel=1;class Oe extends w{constructor(e){super(e),this.hasObject=!1,this.type="normal",this.object=null}onAwake(){const e=this.gameObject.getComponent(Q);e&&e.setColor(D.GREEN)}updateObjectStatus(e){this.hasObject=e}containsObject(){return this.hasObject}setObject(e){this.object=e}getObject(){return this.object}update(e){}render(e){}getPlatformType(){return this.type}setPlatformType(e){this.type=e}}class ve extends Oe{constructor(e){super(e),this.moveSpeed=50,this.moveDirection=R.randomSign(),this.transform=this.gameObject.getComponent(P),this.setPlatformType("moving")}update(e){if(super.update(e),this.transform){const t=this.transform.getWorldPosition(),i=t.x+this.moveDirection*this.moveSpeed*(e/1e3)*_e.getCurrentDifficultyLevel();(i<50||i>H-50)&&(this.moveDirection*=-1),this.transform.setPosition(new _(Math.max(50,Math.min(H-50,i)),t.y))}}}class Ce extends w{constructor(e,t){super(e),this.isActive=!0,this.obstacleType=t,this.setupCollider(),this.setupRenderer(),this.setupObstacleSpecific()}setupCollider(){const e=this.gameObject.getComponent(me);e&&(e.layers=[n.ENVIRONMENT],e.mask=[n.PLAYER],e.isTrigger=!0,e.addEventListener(g,this.onPlayerCollision.bind(this)))}onPlayerCollision(e){const{other:t}=e.data;"Player"===t.getGameObject().tag&&this.onPlayerHit(t.getGameObject())}onPlayerHit(e){e.getComponent(fe).dispatchEvent(Ee,{obstacle:this.gameObject,player:e,obstacleType:this.obstacleType}),j.getInstance().getAudioManager().playSound(L.AUDIO.SFX.HIT)}deactivate(){this.isActive=!1,this.gameObject.setActive(!1);const e=this.gameObject.getComponent(me);e&&j.getInstance()&&j.getInstance().getCollisionManager().removeCollider(e),j.getInstance().getCurrentScene().removeGameObject(this.gameObject)}isObstacleActive(){return this.isActive}getObstacleType(){return this.obstacleType}update(e){this.isActive&&(this.updateObstacle(e),this.checkBounds())}checkBounds(){}render(e){this.isActive&&this.renderEffects(e)}renderEffects(e){}}class Ie extends Ce{constructor(e,t="witch"){super(e,`moving_${t}`),this.moveTime=0,this.movingType=t,this.startPosition=new _(e.getPosition().x,e.getPosition().y),this.setupMovementParameters()}setupMovementParameters(){var e;switch(this.movingType){case"witch":this.moveSpeed=L.OBSTACLES.WITCH.MOVE_SPEED,this.moveRange=L.OBSTACLES.WITCH.MOVE_RANGE,this.movePattern=R.randomChoice(["horizontal","zigzag","circular"]);break;case"flying_monster":this.moveSpeed=L.OBSTACLES.FLYING_MONSTER.MOVE_SPEED,this.movePattern=R.randomChoice(["repeat"])}this.moveDirection=this.getInitialDirection(),null===(e=this.gameObject.getComponent(Q))||void 0===e||e.setFlip(this.moveDirection.x,1)}getInitialDirection(){switch(this.movePattern){case"horizontal":case"repeat":return new _(R.randomSign(),0);case"vertical":return new _(0,R.randomSign());default:return new _(1,0)}}setupRenderer(){}setupObstacleSpecific(){}updateObstacle(e){this.moveTime+=e/1e3,this.updateMovement(e),this.updateSpecialBehaviors(e)}updateMovement(e){const t=this.gameObject.getComponent(P);if(!t)return;const i=t.getWorldPosition();let s=i.clone();switch(this.movePattern){case"horizontal":s=this.updateHorizontalMovement(i,e);break;case"vertical":s=this.updateVerticalMovement(i,e);break;case"circular":s=this.updateCircularMovement(i,e);break;case"zigzag":s=this.updateZigzagMovement(i,e);break;case"repeat":s=this.updateRepeatMovement(i,e)}t.setPosition(s)}updateHorizontalMovement(e,t){var i;const s=this.moveDirection.x*this.moveSpeed*(t/1e3);let n=e.x+s;return Math.abs(n-this.startPosition.x)>this.moveRange&&(this.moveDirection.x*=-1,null===(i=this.gameObject.getComponent(Q))||void 0===i||i.setFlip(this.moveDirection.x,1),n=e.x+this.moveDirection.x*this.moveSpeed*(t/1e3)),new _(n,e.y)}updateRepeatMovement(e,t){const i=this.moveDirection.x*this.moveSpeed*(t/1e3);let s=e.x+i;return s<-L.PLAYER.WIDTH/2?s=H:s>H+L.PLAYER.WIDTH/2&&(s=-L.PLAYER.WIDTH/2),new _(s,e.y)}updateVerticalMovement(e,t){const i=this.moveDirection.y*this.moveSpeed*(t/1e3);let s=e.y+i;return Math.abs(s-this.startPosition.y)>this.moveRange&&(this.moveDirection.y*=-1,s=e.y+this.moveDirection.y*this.moveSpeed*(t/1e3)),new _(e.x,s)}updateCircularMovement(e,t){var i;const s=this.moveRange/2,n=this.moveSpeed/s,a=this.moveTime*n,o=this.startPosition.x+Math.cos(a)*s,r=this.startPosition.y+Math.sin(a)*s*.5;return null===(i=this.gameObject.getComponent(Q))||void 0===i||i.setFlip(o>this.gameObject.getPosition().x?1:-1,1),new _(o,r)}updateZigzagMovement(e,t){var i;const s=this.moveSpeed,n=.5*this.moveSpeed,a=this.moveDirection.x*s*(t/1e3);let o=e.x+a;const r=this.startPosition.y+30*Math.sin(3*this.moveTime)*n*(t/1e3);return Math.abs(o-this.startPosition.x)>this.moveRange&&(this.moveDirection.x*=-1,o=e.x+this.moveDirection.x*s*(t/1e3),null===(i=this.gameObject.getComponent(Q))||void 0===i||i.setFlip(this.moveDirection.x,1)),new _(o,r)}updateSpecialBehaviors(e){}checkBounds(){const e=this.gameObject.getPosition(),t=_.distance(e,this.startPosition);(e.y>U+500||t>3*this.moveRange)&&this.deactivate()}getMoveSpeed(){return this.moveSpeed}setMoveSpeed(e){this.moveSpeed=e}}class we extends Ce{constructor(e,t){super(e,`static_${t}`),this.staticType=t}setupRenderer(){}setupObstacleSpecific(){}updateObstacle(e){}checkBounds(){}}class Pe{static createStaticObstacle(e,t){const i=new M({name:`${t}_${Date.now()}`,tag:"Item",layer:2,position:e}),n=new Q(i),a=new me(i);if("landed_spike"===t){n.setImageSize(L.OBSTACLES.LANDED_SPIKE.WIDTH,L.OBSTACLES.LANDED_SPIKE.HEIGHT);const e=j.getInstance().getResourceManager().getResource(L.OBSTACLES.LANDED_SPIKE.ICON);n.setImage(e),a.type=s.BOX,a.setRenderer(n),i.addComponent(n),i.addComponent(a);const o=new we(i,t);i.addComponent(o)}return j.getInstance().getCollisionManager().addCollider(a),j.getInstance().getCurrentScene().addGameObject(i),i}static createLandedSpike(e){return this.createStaticObstacle(e,"landed_spike")}static createRandomStaticObstacle(e){const t=[{type:"landed_spike",chance:L.OBSTACLES.LANDED_SPIKE.SPAWN_CHANCE}],i=t.reduce((e,t)=>e+t.chance,0);let s=R.random()*i;for(const i of t){if(s<i.chance)return this.createStaticObstacle(e,i.type);s-=i.chance}return this.createStaticObstacle(e,"landed_spike")}static createMovingObstacle(e,t){const i=new M({name:`${t}_${Date.now()}`,tag:"Item",layer:2,position:e}),n=new Q(i),a=new me(i);if("witch"===t){n.setImageSize(L.OBSTACLES.WITCH.WIDTH,L.OBSTACLES.WITCH.HEIGHT);const e=j.getInstance().getResourceManager().getResource(L.OBSTACLES.WITCH.ICON);n.setImage(e),a.type=s.BOX,a.setRenderer(n),i.addComponent(n),i.addComponent(a);const o=new Ie(i,t);i.addComponent(o)}else if("flying_monster"===t){n.setImageSize(L.OBSTACLES.FLYING_MONSTER.WIDTH,L.OBSTACLES.FLYING_MONSTER.HEIGHT);const e=j.getInstance().getResourceManager().getResource(L.OBSTACLES.FLYING_MONSTER.ICON);n.setImage(e),a.type=s.BOX,a.setRenderer(n),i.addComponent(n),i.addComponent(a);const o=new Ie(i,t);i.addComponent(o)}return j.getInstance().getCollisionManager().addCollider(a),j.getInstance().getCurrentScene().addGameObject(i),i}static createWitch(e){return this.createMovingObstacle(e,"witch")}static createFlyingMonster(e){return this.createMovingObstacle(e,"flying_monster")}static createRandomMovingObstacle(e){const t=[{type:"witch",chance:L.OBSTACLES.WITCH.SPAWN_CHANCE},{type:"flying_monster",chance:L.OBSTACLES.FLYING_MONSTER.SPAWN_CHANCE}],i=t.reduce((e,t)=>e+t.chance,0);let s=R.random()*i;for(const i of t){if(s<i.chance)return this.createMovingObstacle(e,i.type);s-=i.chance}return this.createMovingObstacle(e,"witch")}static createRandomObstacleByLevel(e){const t=_e.getCurrentDifficultyLevel(),i=[];t>=L.OBSTACLES.LANDED_SPIKE.SPAWN_LEVEL&&i.push({type:"landed_spike",chance:L.OBSTACLES.LANDED_SPIKE.SPAWN_CHANCE,create:e=>this.createLandedSpike(e)}),t>=L.OBSTACLES.FLYING_MONSTER.SPAWN_LEVEL&&i.push({type:"flying_monster",chance:L.OBSTACLES.FLYING_MONSTER.SPAWN_CHANCE,create:e=>this.createFlyingMonster(e)}),t>=L.OBSTACLES.WITCH.SPAWN_LEVEL&&i.push({type:"witch",chance:L.OBSTACLES.WITCH.SPAWN_CHANCE,create:e=>this.createWitch(e)});const s=i.reduce((e,t)=>e+t.chance,0);if(0===s)return this.createLandedSpike(e);let n=R.random()*s;for(const t of i){if(n<t.chance)return t.create(e);n-=t.chance}return this.createLandedSpike(e)}}class Me extends w{constructor(e,t){super(e),this.isActive=!0,this.itemType=t,this.spawnTime=Date.now(),this.setupCollider(),this.setupRenderer(),this.setupItemSpecific()}setupCollider(){const e=this.gameObject.getComponent(me);e&&(e.layers=[n.ENVIRONMENT],e.mask=[n.PLAYER],e.isTrigger=!0,e.addEventListener(g,this.onPlayerCollision.bind(this)))}onPlayerCollision(e){const{other:t}=e.data;console.log("Player collided with item:",this.itemType),"Player"===t.getGameObject().tag&&this.onPlayerHit(t.getGameObject())}onPlayerHit(e){this.dispatchEvent("player_hit_item",{item:this.gameObject,player:e,itemType:this.itemType}),"trampoline"!==this.itemType&&this.deactivate()}deactivate(){this.isActive=!1,this.gameObject.setActive(!1);const e=this.gameObject.getComponent(me);e&&j.getInstance()&&j.getInstance().getCollisionManager().removeCollider(e),j.getInstance().getCurrentScene().removeGameObject(this.gameObject),this.gameObject.destroy()}update(e){this.isActive&&(this.updateItem(e),this.checkBounds())}checkBounds(){}render(e){this.isActive&&this.renderEffects(e)}renderEffects(e){}}class Le extends Me{updateItem(e){}constructor(e){super(e,"trampoline")}setupRenderer(){}setupItemSpecific(){}onPlayerHit(e){super.onPlayerHit(e);const t=e.getComponent(ae);if(t){const e=t.velocity.clone();e.y=-L.ITEMS.TRAMPOLINE.BOUNCE_FORCE,t.setVelocity(e),j.getInstance().getAudioManager().playSound(L.AUDIO.SFX.TRAMPOLINE,!1)}}}class Re extends Me{updateItem(e){}constructor(e){super(e,"jetpack")}setupRenderer(){}setupItemSpecific(){}onPlayerHit(e){super.onPlayerHit(e);const t=e.getComponent(fe);t&&(t.setUsingJetpack(!0),j.getInstance().getAudioManager().playSound(L.AUDIO.SFX.JETPACK))}}class De{static createItems(e,t){const i=new M({name:`${t}_${Date.now()}`,tag:"Item",layer:2,position:e}),n=new Q(i),a=new me(i);if("trampoline"===t){n.setImageSize(L.ITEMS.TRAMPOLINE.WIDTH,L.ITEMS.TRAMPOLINE.HEIGHT);const e=j.getInstance().getResourceManager().getResource(L.ITEMS.TRAMPOLINE.ICON);n.setImage(e),a.type=s.BOX,a.setRenderer(n),i.addComponent(n),i.addComponent(a);const t=new Le(i);i.addComponent(t)}else if("jetpack"===t){n.setImageSize(L.ITEMS.JETPACK.WIDTH,L.ITEMS.JETPACK.HEIGHT);const e=j.getInstance().getResourceManager().getResource(L.ITEMS.JETPACK.ICON);n.setImage(e),a.type=s.BOX,a.setRenderer(n),i.addComponent(n),i.addComponent(a);const t=new Re(i);i.addComponent(t)}return j.getInstance().getCollisionManager().addCollider(a),j.getInstance().getCurrentScene().addGameObject(i),i}static createTrampoline(e){return this.createItems(e,"trampoline")}static createJetpack(e){return this.createItems(e,"jetpack")}static createRandomItem(e){const t=[{type:"trampoline",chance:L.ITEMS.TRAMPOLINE.SPAWN_CHANCE},{type:"jetpack",chance:L.ITEMS.JETPACK.SPAWN_CHANCE}],i=t.reduce((e,t)=>e+t.chance,0);let s=R.random()*i;for(const i of t){if(s<i.chance)return this.createItems(e,i.type);s-=i.chance}return this.createItems(e,"trampoline")}}class xe extends w{constructor(e,t){super(e),this.platformsImg=[],this.platforms=[],this.lastPlatformX=H/2,this.MAX_PLATFORM_X_DIFF=H/2,this.scene=t}onStart(){this.gameEngine=j.getInstance(),this.generateGround(),this.loadPlatformImages(),this.generateInitialPlatforms()}update(e){this.generateNewPlatforms(),this.removeOldPlatforms()}loadPlatformImages(){for(const e of Object.keys(L.IMAGES.PLATFORMS))this.platformsImg.push(this.gameEngine.getResourceManager().getResource(L.IMAGES.PLATFORMS[e]))}generateGround(){const e=new M({name:"Ground",tag:"Ground",layer:2,position:new _(H/2,U)}),t=new Q(e);t.setImage(this.gameEngine.getResourceManager().getResource(L.IMAGES.GROUND)),t.setImageSize(H+64,156),e.addComponent(t);const i=new me(e);i.setRenderer(t),i.setColliderType(s.POLYGON),i.layers=[n.GROUND],i.mask=[n.PLAYER],e.addComponent(i),this.platforms.push(new Oe(e)),this.scene.addGameObject(e),this.gameEngine.getCollisionManager().addCollider(i)}generateInitialPlatforms(){for(let e=1;e<L.PLATFORM.INITIAL_COUNT;e++){const t=U-32-e*L.PLATFORM.SPAWN_DISTANCE;this.createPlatformWithConstraint(t,!1)}}createPlatformWithConstraint(e,t=!0){const i=Math.max(L.PLATFORM.WIDTH/2,this.lastPlatformX-this.MAX_PLATFORM_X_DIFF),s=Math.min(H-L.PLATFORM.WIDTH/2,this.lastPlatformX+this.MAX_PLATFORM_X_DIFF),n=R.random(i,s);return this.lastPlatformX=n,this.createPlatform(new _(n,e),t)}createPlatform(e,t=!0){const i=new M({name:"Platform",tag:"Platform",layer:2,position:e}),a=new Q(i),o=this.platformsImg[R.randomInt(0,this.platformsImg.length-1)];a.setImage(o),a.setImageSize(L.PLATFORM.WIDTH,L.PLATFORM.HEIGHT),a.setColor(D.WHITE),i.addComponent(a);const r=new me(i);r.setRenderer(a),r.setColliderSize(a.getWidth()-12,a.getHeight()),r.setColliderType(s.POLYGON),r.layers=[n.GROUND],r.mask=[n.PLAYER],i.addComponent(r);let h=new Oe(i);const l=.05*_e.getCurrentDifficultyLevel();return R.random(0,1)<l&&(h=new ve(i)),i.addComponent(h),this.scene.addGameObject(i),this.platforms.push(h),t&&"normal"===h.getPlatformType()&&this.maybeAddObjectOnPlatform(i),this.gameEngine.getCollisionManager().addCollider(r),i}maybeAddObjectOnPlatform(e){var t,i,s,n,a,o;const r=e.getComponent(Oe);if(null===r)return;if(r.containsObject())return;const h=_e.getCurrentDifficultyLevel(),l=Math.min(.1+.05*h,.4),c=R.random(0,1),d=e.getPosition().add(new _(0,-L.PLATFORM.HEIGHT/2));if(c<l){const e=Pe.createRandomObstacleByLevel(d);return this.scene.addGameObject(e),null===(t=r.updateObjectStatus)||void 0===t||t.call(r,!0),void(null===(i=r.setObject)||void 0===i||i.call(r,e))}if(c<l+.1){const e=De.createRandomItem(d.add(new _(0,-24)));return this.scene.addGameObject(e),null===(s=r.updateObjectStatus)||void 0===s||s.call(r,!0),void(null===(n=r.setObject)||void 0===n||n.call(r,e))}if(c<l+.1+.25){const t=this.createDecorationOnPlatform(e);t&&(this.scene.addGameObject(t),null===(a=r.updateObjectStatus)||void 0===a||a.call(r,!0),null===(o=r.setObject)||void 0===o||o.call(r,t))}}createDecorationOnPlatform(e){const t=Object.keys(L.IMAGES.DECORATIONS),i=R.randomChoice(t),s=e.getPosition().add(new _(R.random(-30,30),-L.PLATFORM.HEIGHT/2-L.DECORATION.HEIGHT/2+12)),n=new M({name:`Deco_${i}`,tag:"Decoration",layer:2,position:s}),a=new Q(n),o=this.gameEngine.getResourceManager().getResource(L.IMAGES.DECORATIONS[i]);return a.setImage(o),a.setImageSize(L.DECORATION.WIDTH,L.DECORATION.HEIGHT),n.addComponent(a),n}generateNewPlatforms(){let e=Number.POSITIVE_INFINITY;for(const t of this.platforms){const i=t.getGameObject().getPosition().y;i<e&&(e=i)}const t=this.scene.getMainCamera().getGameObject().getPosition().y-U/2-200;for(;e>t;)e-=L.PLATFORM.SPAWN_DISTANCE,this.createPlatformWithConstraint(e)}removeOldPlatforms(){const e=this.scene.getMainCamera().getGameObject().getPosition().y;this.platforms=this.platforms.filter(t=>{if(t.getGameObject().getPosition().y-e>U/2+L.PLATFORM.HEIGHT){if(t.containsObject()){const e=t.getObject();e&&(this.scene.removeGameObject(e),e.destroy())}return this.scene.removeGameObject(t.getGameObject()),t.getGameObject().destroy(),!1}return!0})}render(e){}}var Ne=function(e,t,i,s){return new(i||(i=Promise))(function(n,a){function o(e){try{h(s.next(e))}catch(e){a(e)}}function r(e){try{h(s.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,r)}h((s=s.apply(e,t||[])).next())})};class Ge extends ce{constructor(e="GameplayScene"){super(e),this.gameState=h.PLAYING,this.isGameOver=!1}onLoad(){return Ne(this,void 0,void 0,function*(){console.log("Loading Gameplay Scene..."),this.gameEngine=j.getInstance(),this.gameState=h.PLAYING,this.isGameOver=!1,yield this.createCamera(),yield this.createPlayer(),yield this.createPlatformManager(),yield this.createBackgroundManager(),yield this.createScoreManager(),yield this.createInputManager(),this.setupSystemConnections(),console.log("Gameplay Scene loaded successfully!")})}onUnload(){return Ne(this,void 0,void 0,function*(){console.log("Unloading Gameplay Scene..."),this.gameEngine.getUIManager()})}createCamera(){return Ne(this,void 0,void 0,function*(){this.camera=new M({name:"MainCamera",position:new _(H/2,U/2)});const e=new Ae(this.camera);this.camera.addComponent(e),this.addGameObject(this.camera),this.mainCamera=e})}createPlayer(){return Ne(this,void 0,void 0,function*(){this.player=new M({name:"Player",tag:"Player",layer:1e3,position:new _(H/2,U-120)});const e=new ae(this.player);e.mass=1,e.drag=.98,e.useGravity=!0,e.setVelocity(new _(0,0)),this.player.addComponent(e);const t=new Z(this.player);t.addAnimation(L.ANIMATIONS.PLAYER_IDLE.name,L.ANIMATIONS.PLAYER_IDLE.frames,this.gameEngine,L.ANIMATIONS.PLAYER_IDLE.frameRate,L.ANIMATIONS.PLAYER_IDLE.loop),t.addAnimation(L.ANIMATIONS.PLAYER_IDLE_JETPACK.name,L.ANIMATIONS.PLAYER_IDLE_JETPACK.frames,this.gameEngine,L.ANIMATIONS.PLAYER_IDLE_JETPACK.frameRate,L.ANIMATIONS.PLAYER_IDLE_JETPACK.loop),t.addAnimation(L.ANIMATIONS.PLAYER_MOVE_LEFT.name,L.ANIMATIONS.PLAYER_MOVE_LEFT.frames,this.gameEngine,L.ANIMATIONS.PLAYER_MOVE_LEFT.frameRate,L.ANIMATIONS.PLAYER_MOVE_LEFT.loop),t.addAnimation(L.ANIMATIONS.PLAYER_MOVE_LEFT_JETPACK.name,L.ANIMATIONS.PLAYER_MOVE_LEFT_JETPACK.frames,this.gameEngine,L.ANIMATIONS.PLAYER_MOVE_LEFT_JETPACK.frameRate,L.ANIMATIONS.PLAYER_MOVE_LEFT_JETPACK.loop),t.addAnimation(L.ANIMATIONS.PLAYER_MOVE_RIGHT.name,L.ANIMATIONS.PLAYER_MOVE_RIGHT.frames,this.gameEngine,L.ANIMATIONS.PLAYER_MOVE_RIGHT.frameRate,L.ANIMATIONS.PLAYER_MOVE_RIGHT.loop),t.addAnimation(L.ANIMATIONS.PLAYER_MOVE_RIGHT_JETPACK.name,L.ANIMATIONS.PLAYER_MOVE_RIGHT_JETPACK.frames,this.gameEngine,L.ANIMATIONS.PLAYER_MOVE_RIGHT_JETPACK.frameRate,L.ANIMATIONS.PLAYER_MOVE_RIGHT_JETPACK.loop),t.addAnimation(L.ANIMATIONS.PLAYER_JUMP.name,L.ANIMATIONS.PLAYER_JUMP.frames,this.gameEngine,L.ANIMATIONS.PLAYER_JUMP.frameRate,L.ANIMATIONS.PLAYER_JUMP.loop),t.addAnimation(L.ANIMATIONS.PLAYER_DEAD.name,L.ANIMATIONS.PLAYER_DEAD.frames,this.gameEngine,L.ANIMATIONS.PLAYER_DEAD.frameRate,L.ANIMATIONS.PLAYER_DEAD.loop),t.playAnimation(L.ANIMATIONS.PLAYER_IDLE.name),this.player.addComponent(t);const i=me.createBox(this.player,L.PLAYER.WIDTH,L.PLAYER.HEIGHT);i.layers=[n.PLAYER],i.mask=[n.GROUND,n.ENVIRONMENT],this.player.addComponent(i);const s=new fe(this.player);this.playerComponent=s,this.player.addComponent(s),s.addEventListener("player_fell",this.onPlayerFell.bind(this)),s.addEventListener(Ee,this.onPlayerHitObstacle.bind(this)),s.addEventListener(pe,this.onPlayerJump.bind(this)),this.addGameObject(this.player)})}createPlatformManager(){return Ne(this,void 0,void 0,function*(){const e=new M({name:"PlatformManager"});this.platformManager=new xe(e,this),e.addComponent(this.platformManager),this.addGameObject(e)})}createBackgroundManager(){return Ne(this,void 0,void 0,function*(){const e=new M({name:"BackgroundManager"});this.backgroundManager=new be(e,this),e.addComponent(this.backgroundManager),this.addGameObject(e)})}createScoreManager(){return Ne(this,void 0,void 0,function*(){const e=new M({name:"ScoreManager"});this.scoreManager=new _e(e),e.addComponent(this.scoreManager),this.addGameObject(e)})}createInputManager(){return Ne(this,void 0,void 0,function*(){const e=new M({name:"InputManager"});this.inputManager=new Te(e,this.gameEngine.getInputManager()),e.addComponent(this.inputManager),this.addGameObject(e)})}setupSystemConnections(){const e=this.camera.getComponent(Ae);e&&e.setTarget(this.player),this.backgroundManager&&this.mainCamera&&this.backgroundManager.setCamera(this.mainCamera),this.scoreManager&&this.scoreManager.setPlayer(this.player);const t=this.player.getComponent(fe);this.inputManager&&t&&this.inputManager.setPlayer(t)}onPlayerFell(e){this.triggerGameOver()}onPlayerHitObstacle(e){this.gameState===h.GAMEOVER||this.isGameOver||(this.gameState=h.GAMEOVER,this.triggerGameOver())}onPlayerJump(e){}checkGameOver(){if(this.gameState===h.GAMEOVER)return;const e=this.player.getComponent(P);if(!e)return;const t=e.getWorldPosition(),i=this.getMainCamera().getGameObject().getPosition().y;return t.y>i+U/2?(this.playerComponent.setPlayerDead(!0),void this.triggerGameOver()):void 0}triggerGameOver(){if(this.isGameOver)return;this.isGameOver=!0;const e=this.scoreManager.getCurrentScore(),t=this.scoreManager.getHighScore();localStorage.setItem(L.HIGH_SCORE_KEY,t.toString()),localStorage.setItem(L.CURRENT_SCORE_KEY,e.toString()),console.log(`Game Over! Score: ${e}, High Score: ${t}`),setTimeout(()=>{this.gameEngine.setScene("GameOverScene")},2e3)}onUpdate(e){this.gameEngine.getInputManager().isKeyJustPressed("KeyR")&&this.isGameOver&&this.restartGame(),this.checkGameOver()}onRender(e){this.backgroundManager&&this.backgroundManager.render(e),e.save(),e.font="24px Arial",e.fillStyle="#fff",e.textAlign="left",e.fillText(`Score: ${this.scoreManager.getCurrentScore()}`,100,300),e.restore()}restartGame(){console.log("Restarting game..."),this.gameEngine.setScene("GameplayScene")}getScore(){return this.scoreManager?this.scoreManager.getCurrentScore():0}getHighScore(){return this.scoreManager?this.scoreManager.getHighScore():0}}var Be,ke,je=function(e,t,i,s){return new(i||(i=Promise))(function(n,a){function o(e){try{h(s.next(e))}catch(e){a(e)}}function r(e){try{h(s.throw(e))}catch(e){a(e)}}function h(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,r)}h((s=s.apply(e,t||[])).next())})};class He extends ce{constructor(e="MainMenuScene"){super(e),this.isSoundOn="true"===localStorage.getItem(L.AUDIO_ENABLED_KEY),this.introAnimationComplete=!1,this.backgroundAnimationTime=0}onLoad(){return je(this,void 0,void 0,function*(){console.log("Loading Main Menu Scene..."),this.gameEngine=j.getInstance(),this.gameEngine.getAudioManager().playBackgroundMusic(L.AUDIO.MUSIC.BACKGROUND_MUSIC,{loop:!0,volume:.5}),yield this.createBackground(),yield this.createEffectSystems(),yield this.createUI(),yield this.playIntroAnimation(),console.log("Main Menu Scene loaded successfully!")})}onUnload(){return je(this,void 0,void 0,function*(){console.log("Unloading Main Menu Scene...");const e=this.gameEngine.getUIManager();e&&this.backgroundPanel&&e.removeRootElement(this.backgroundPanel)})}createBackground(){return je(this,void 0,void 0,function*(){const e=new M({name:"MenuBackground"});this.addGameObject(e)})}createEffectSystems(){return je(this,void 0,void 0,function*(){const e=new M({name:"UIAnimator"});this.animator=new oe(e),e.addComponent(this.animator),this.addGameObject(e);const t=new M({name:"MenuParticles"});this.particleSystem=new te(t,200),t.addComponent(this.particleSystem),this.addGameObject(t)})}createUI(){return je(this,void 0,void 0,function*(){yield this.createBackgroundPanel(),yield this.createTitle(),yield this.createSubtitle(),yield this.createHighScoreDisplay(),yield this.createPlayButton(),yield this.createInstructions(),yield this.createSoundToggleButton(),this.addUIToManager()})}createBackgroundPanel(){return je(this,void 0,void 0,function*(){const e=new M({name:"MenuBackgroundPanel",position:new _(0,0)});this.backgroundPanel=new ne(e),this.backgroundPanel.setAnchor(d.MIDDLE_CENTER),this.backgroundPanel.size=new _(800,700),this.backgroundPanel.setGradient([new D(20,30,60,.95),new D(40,20,80,.95),new D(60,30,100,.95)]),this.backgroundPanel.enableAnimatedGradient(!0),this.backgroundPanel.enableGlassEffect(!0),this.backgroundPanel.enableBorderGlow(!0),this.backgroundPanel.enableFloating(!0,3),this.backgroundPanel.cornerRadius=25,this.backgroundPanel.borderColor=new D(100,200,255,.6),this.backgroundPanel.borderWidth=3;const t=new M({name:"BackgroundRenderer",position:new _(H/2,U/2-50)}),i=t.addComponent(new Q(t));i.setColor(new D(255,255,255,.1));const s=this.gameEngine.getResourceManager().getResource(L.IMAGES.BACKGROUND.MAINMENU_BACKGROUND);i.setImage(s),i.setImageSize(.75*H,.75*U),e.addComponent(this.backgroundPanel),this.addGameObject(t),this.addGameObject(e)})}createTitle(){return je(this,void 0,void 0,function*(){const e=new M({name:"GameTitle",position:new _(H/2-300,150),layer:10});this.titleLabel=new se(e,"DOODLE JUMP"),this.titleLabel.setAnchor(d.MIDDLE_CENTER),this.titleLabel.setFont('48px "Arial Black", Arial'),this.titleLabel.setColor(D.BLACK),this.titleLabel.setTextAlign("center"),this.titleLabel.size=new _(600,80),this.titleLabel.enableGlow(!0),this.titleLabel.enablePulse(!0),e.setActive(!1),e.addComponent(this.titleLabel),this.backgroundPanel.addChild(this.titleLabel)})}createSubtitle(){return je(this,void 0,void 0,function*(){const e=new M({name:"GameSubtitle",position:new _(H/2-200,225)});this.subtitleLabel=new se(e,"Jump to the Sky!"),this.subtitleLabel.setAnchor(d.MIDDLE_CENTER),this.subtitleLabel.setFont("24px Arial"),this.subtitleLabel.setColor(new D(200,200,200,.9)),this.subtitleLabel.setTextAlign("center"),this.subtitleLabel.size=new _(400,40),e.addComponent(this.subtitleLabel),e.setActive(!1),this.backgroundPanel.addChild(this.subtitleLabel)})}createHighScoreDisplay(){return je(this,void 0,void 0,function*(){const e=this.getHighScore(),t=new M({name:"HighScoreDisplay",position:new _(H/2-150,325)});this.highScoreLabel=new se(t,` High Score: ${e}`),this.highScoreLabel.setAnchor(d.MIDDLE_CENTER),this.highScoreLabel.setFont("20px Arial"),this.highScoreLabel.setColor(new D(255,215,0,1)),this.highScoreLabel.setTextAlign("center"),this.highScoreLabel.size=new _(300,30),this.highScoreLabel.enableGlow(!0),t.addComponent(this.highScoreLabel),t.setActive(!1),this.backgroundPanel.addChild(this.highScoreLabel)})}createPlayButton(){return je(this,void 0,void 0,function*(){const e=new M({name:"PlayButton",position:new _(H/2-100,U/2+50)});this.playButton=new ie(e,"PLAY GAME"),this.playButton.setAnchor(d.MIDDLE_CENTER),this.playButton.size=new _(210,64),this.playButton.setColors(new D(50,200,50,1),new D(255,255,255,1),new D(80,230,80,1)),this.playButton.enableHoverEffect=!0,this.playButton.enableClickEffect=!0,this.playButton.enableGlow=!0,this.playButton.enablePulse=!0,this.playButton.cornerRadius=15,this.playButton.borderWidth=3,this.playButton.borderColor=new D(255,255,255,.5),this.playButton.label&&this.playButton.label.setFont('24px "Arial Black", Arial'),this.playButton.setOnClick(()=>this.onPlayButtonClick()),e.addComponent(this.playButton),e.setActive(!1),this.backgroundPanel.addChild(this.playButton)})}createInstructions(){return je(this,void 0,void 0,function*(){const e=new M({name:"Instructions",position:new _(H/2-300,U-100)});this.instructionsLabel=new se(e," Controls:   or A D to move   or W to use Boost"),this.instructionsLabel.setAnchor(d.MIDDLE_CENTER),this.instructionsLabel.setFont("16px Arial"),this.instructionsLabel.setColor(new D(180,180,255,.8)),this.instructionsLabel.setTextAlign("center"),this.instructionsLabel.size=new _(600,40),e.addComponent(this.instructionsLabel),e.setActive(!1),this.backgroundPanel.addChild(this.instructionsLabel)})}createSoundToggleButton(){return je(this,void 0,void 0,function*(){const e=new M({name:"SoundToggleButton",position:new _(H/2+300,75)});this.soundToggleButton=new ie(e,""),this.soundToggleButton.size=new _(48,48),this.soundToggleButton.setColors(new D(220,220,220,1),new D(255,255,255,1),new D(180,180,180,1));const t=this.gameEngine.getResourceManager().getResource(L.IMAGES.BUTTON.SOUND_ON_BUTTON),i=this.gameEngine.getResourceManager().getResource(L.IMAGES.BUTTON.SOUND_OFF_BUTTON);this.gameEngine.getAudioManager().setEnabled(this.isSoundOn),this.soundToggleButton.setBackgroundImage(this.isSoundOn?t:i),this.soundToggleButton.enableHoverEffect=!0,this.soundToggleButton.enableClickEffect=!0,this.soundToggleButton.cornerRadius=12,this.soundToggleButton.borderWidth=2,this.soundToggleButton.borderColor=new D(100,100,100,.4),this.soundToggleButton.setOnClick(()=>this.toggleSound()),e.addComponent(this.soundToggleButton),e.setActive(!0),this.backgroundPanel.addChild(this.soundToggleButton)})}toggleSound(){this.isSoundOn=!this.isSoundOn,localStorage.setItem(L.AUDIO_ENABLED_KEY,String(this.isSoundOn));const e=this.gameEngine.getResourceManager().getResource(L.IMAGES.BUTTON.SOUND_ON_BUTTON),t=this.gameEngine.getResourceManager().getResource(L.IMAGES.BUTTON.SOUND_OFF_BUTTON);this.soundToggleButton.setBackgroundImage(this.isSoundOn?e:t),this.gameEngine.getAudioManager().setEnabled(this.isSoundOn)}addUIToManager(){const e=this.gameEngine.getUIManager();e&&this.backgroundPanel&&e.addRootElement(this.backgroundPanel)}playIntroAnimation(){return je(this,void 0,void 0,function*(){this.animator.animate(this.backgroundPanel,{type:E.FadeIn,duration:1e3,easing:he.easeOutCubic}),setTimeout(()=>{this.titleLabel.getGameObject().setActive(!0),this.animator.animate(this.titleLabel,{type:E.SLIDE_IN_FROM_TOP,duration:800,easing:he.easeOutBounce})},200),setTimeout(()=>{this.subtitleLabel.getGameObject().setActive(!0),this.subtitleLabel.startTypewriter(30)},1e3),setTimeout(()=>{this.highScoreLabel.getGameObject().setActive(!0),this.animator.animate(this.highScoreLabel,{type:E.SLIDE_IN_FROM_LEFT,duration:600,easing:he.easeOutQuad})},1200),setTimeout(()=>{this.playButton.getGameObject().setActive(!0),this.animator.animate(this.playButton,{type:E.BOUNCE,duration:500,easing:he.easeOutElastic,onComplete:()=>{this.introAnimationComplete=!0,this.startContinuousEffects()}})},1500),setTimeout(()=>{this.instructionsLabel.getGameObject().setActive(!0),this.instructionsLabel.startTypewriter(50)},1800)})}startContinuousEffects(){setInterval(()=>{const e=Math.random()*H,t=Math.random()*U;this.particleSystem.emitStars(new _(e,t),1)},500),setInterval(()=>{const e=this.titleLabel.getWorldBounds(),t=e.x+Math.random()*e.width,i=e.y+Math.random()*e.height;this.particleSystem.emitSparkles(new _(t,i),3)},1e3)}onPlayButtonClick(){if(console.log("Starting game from menu..."),this.playButton&&this.particleSystem){const e=this.playButton.getWorldBounds(),t=new _(e.x+e.width/2,e.y+e.height/2);this.particleSystem.emitConfetti(t,30)}setTimeout(()=>{this.gameEngine.setScene("GameplayScene")},300)}getHighScore(){try{const e=localStorage.getItem(L.HIGH_SCORE_KEY);return e?parseInt(e,10):0}catch(e){return 0}}onUpdate(e){this.backgroundAnimationTime+=e}onRender(e){this.renderAnimatedBackground(e),this.particleSystem&&this.particleSystem.render(e),this.drawDecorations(e)}renderAnimatedBackground(e){const t=.001*this.backgroundAnimationTime,i=20*t%360,s=(30*t+180)%360,n=e.createLinearGradient(0,0,0,U);n.addColorStop(0,D.fromHSL({h:i,s:60,l:20}).toString()),n.addColorStop(.5,D.fromHSL({h:s,s:40,l:15}).toString()),n.addColorStop(1,D.fromHSL({h:i+60,s:50,l:10}).toString()),e.fillStyle=n,e.fillRect(0,0,H,U)}drawDecorations(e){this.introAnimationComplete&&(e.save(),this.drawFloatingShapes(e),this.drawCornerDecorations(e),this.drawMobileHint(e),e.restore())}drawFloatingShapes(e){const t=5e-4*this.backgroundAnimationTime;for(let i=0;i<8;i++){const s=t+i*Math.PI/4,n=200+50*Math.sin(t+i),a=H/2+Math.cos(s)*n,o=U/2+Math.sin(s)*n,r=3+2*Math.sin(2*t+i);e.fillStyle=`hsla(${(100*t+45*i)%360}, 70%, 60%, 0.3)`,e.beginPath(),e.arc(a,o,r,0,2*Math.PI),e.fill()}}drawCornerDecorations(e){const t=.002*this.backgroundAnimationTime;this.drawCornerPattern(e,50,50,t),this.drawCornerPattern(e,H-50,50,t+Math.PI),this.drawCornerPattern(e,50,U-50,t+Math.PI/2),this.drawCornerPattern(e,H-50,U-50,t+1.5*Math.PI)}drawCornerPattern(e,t,i,s){for(let n=0;n<3;n++){const a=15*(n+1),o=.4-.1*n,r=s+.5*n;e.strokeStyle=`rgba(255, 255, 255, ${o})`,e.lineWidth=2,e.beginPath(),e.arc(t,i,a,r,r+Math.PI),e.stroke()}}drawMobileHint(e){if("ontouchstart"in window&&this.introAnimationComplete){e.save(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="16px Arial",e.textAlign="center";const t=.5+.3*Math.sin(.003*this.backgroundAnimationTime);e.globalAlpha=t,e.fillText("Tap anywhere to start!",H/2,U-30),e.restore()}}updateHighScore(){const e=this.getHighScore();this.highScoreLabel&&this.highScoreLabel.setText(`High Score: ${e}`)}}ke=function*(){yield q.start({width:1e3,height:800,targetFPS:60,scenes:[new He,new Ge,new ue],preloadAssets:{images:[{name:L.IMAGES.BACKGROUND.GAMEPLAY_BACKGROUND,url:"assets/images/background/gameplay_background.png"},{name:L.IMAGES.BACKGROUND.MAINMENU_BACKGROUND,url:"assets/images/background/main_menu_background.png"},{name:L.IMAGES.CLOUD,url:"assets/images/decoration/cloud.png"},{name:L.IMAGES.GROUND,url:"assets/images/platform/ground.png"},{name:L.IMAGES.PLATFORMS.PLATFORM_1,url:"assets/images/platform/platform_1.png"},{name:L.IMAGES.PLATFORMS.PLATFORM_2,url:"assets/images/platform/platform_2.png"},{name:L.IMAGES.PLATFORMS.PLATFORM_3,url:"assets/images/platform/platform_3.png"},{name:L.IMAGES.PLATFORMS.PLATFORM_4,url:"assets/images/platform/platform_4.png"},{name:L.IMAGES.PLATFORMS.PLATFORM_5,url:"assets/images/platform/platform_5.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE+"_1",url:"assets/images/player/idle/player_idle_1.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE+"_2",url:"assets/images/player/idle/player_idle_2.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE+"_3",url:"assets/images/player/idle/player_idle_3.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE+"_4",url:"assets/images/player/idle/player_idle_4.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE+"_5",url:"assets/images/player/idle/player_idle_5.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE+"_6",url:"assets/images/player/idle/player_idle_6.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE_JETPACK+"_1",url:"assets/images/player/jetpack/idle/player_idle_jetpack_1.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE_JETPACK+"_2",url:"assets/images/player/jetpack/idle/player_idle_jetpack_2.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE_JETPACK+"_3",url:"assets/images/player/jetpack/idle/player_idle_jetpack_3.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE_JETPACK+"_4",url:"assets/images/player/jetpack/idle/player_idle_jetpack_4.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE_JETPACK+"_5",url:"assets/images/player/jetpack/idle/player_idle_jetpack_5.png"},{name:L.IMAGES.PLAYERS.PLAYER_IDLE_JETPACK+"_6",url:"assets/images/player/jetpack/idle/player_idle_jetpack_6.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_LEFT+"_1",url:"assets/images/player/move_left/player_move_left_1.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_LEFT+"_2",url:"assets/images/player/move_left/player_move_left_2.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_LEFT+"_3",url:"assets/images/player/move_left/player_move_left_3.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_LEFT+"_4",url:"assets/images/player/move_left/player_move_left_4.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_LEFT_JETPACK+"_1",url:"assets/images/player/jetpack/move_left/player_move_left_jetpack_1.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_LEFT_JETPACK+"_2",url:"assets/images/player/jetpack/move_left/player_move_left_jetpack_2.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_LEFT_JETPACK+"_3",url:"assets/images/player/jetpack/move_left/player_move_left_jetpack_3.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_LEFT_JETPACK+"_4",url:"assets/images/player/jetpack/move_left/player_move_left_jetpack_4.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_RIGHT+"_1",url:"assets/images/player/move_right/player_move_right_1.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_RIGHT+"_2",url:"assets/images/player/move_right/player_move_right_2.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_RIGHT+"_3",url:"assets/images/player/move_right/player_move_right_3.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_RIGHT+"_4",url:"assets/images/player/move_right/player_move_right_4.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_RIGHT_JETPACK+"_1",url:"assets/images/player/jetpack/move_right/player_move_right_jetpack_1.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_RIGHT_JETPACK+"_2",url:"assets/images/player/jetpack/move_right/player_move_right_jetpack_2.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_RIGHT_JETPACK+"_3",url:"assets/images/player/jetpack/move_right/player_move_right_jetpack_3.png"},{name:L.IMAGES.PLAYERS.PLAYER_MOVE_RIGHT_JETPACK+"_4",url:"assets/images/player/jetpack/move_right/player_move_right_jetpack_4.png"},{name:L.IMAGES.PLAYERS.PLAYER_JUMP+"_1",url:"assets/images/player/jump/player_jump_1.png"},{name:L.IMAGES.PLAYERS.PLAYER_JUMP+"_2",url:"assets/images/player/jump/player_jump_2.png"},{name:L.IMAGES.PLAYERS.PLAYER_JUMP+"_3",url:"assets/images/player/jump/player_jump_3.png"},{name:L.IMAGES.PLAYERS.PLAYER_DEAD,url:"assets/images/player/dead/player_dead.png"},{name:L.OBSTACLES.LANDED_SPIKE.ICON,url:"assets/images/obstacle/landed_spike.png"},{name:L.OBSTACLES.FLYING_MONSTER.ICON,url:"assets/images/obstacle/flying_monster.png"},{name:L.OBSTACLES.WITCH.ICON,url:"assets/images/obstacle/witch.png"},{name:L.ITEMS.TRAMPOLINE.ICON,url:"assets/images/items/trampoline.png"},{name:L.ITEMS.JETPACK.ICON,url:"assets/images/items/jetpack.png"},{name:L.IMAGES.DECORATIONS.TREE_1,url:"assets/images/decoration/tree_1.png"},{name:L.IMAGES.DECORATIONS.TREE_2,url:"assets/images/decoration/tree_2.png"},{name:L.IMAGES.DECORATIONS.TREE_3,url:"assets/images/decoration/tree_3.png"},{name:L.IMAGES.DECORATIONS.TREE_4,url:"assets/images/decoration/tree_4.png"},{name:L.IMAGES.DECORATIONS.LAMP_POST_1,url:"assets/images/decoration/lamp_post_1.png"},{name:L.IMAGES.DECORATIONS.LAMP_POST_2,url:"assets/images/decoration/lamp_post_2.png"},{name:L.IMAGES.BUTTON.SOUND_ON_BUTTON,url:"assets/images/button/sound_on_button.png"},{name:L.IMAGES.BUTTON.SOUND_OFF_BUTTON,url:"assets/images/button/sound_off_button.png"}],audio:[{name:L.AUDIO.SFX.JUMP,url:"assets/audio/sfx/jump.mp3"},{name:L.AUDIO.SFX.TRAMPOLINE,url:"assets/audio/sfx/trampoline.m4a"},{name:L.AUDIO.SFX.JETPACK,url:"assets/audio/sfx/jetpack.mp3"},{name:L.AUDIO.SFX.WALK,url:"assets/audio/sfx/walk.mp3"},{name:L.AUDIO.SFX.BUTTON_CLICK,url:"assets/audio/sfx/button_click.mp3"},{name:L.AUDIO.MUSIC.BACKGROUND_MUSIC,url:"assets/audio/music/background_music.mp3"},{name:L.AUDIO.SFX.HIT,url:"assets/audio/sfx/hit.mp3"}]}})},new((Be=void 0)||(Be=Promise))(function(e,t){function i(e){try{n(ke.next(e))}catch(e){t(e)}}function s(e){try{n(ke.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof Be?n:new Be(function(e){e(n)})).then(i,s)}n((ke=ke.apply(void 0,[])).next())})})();